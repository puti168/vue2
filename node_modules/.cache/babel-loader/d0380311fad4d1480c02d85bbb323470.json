{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\authoritymanagement\\agentRelation\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\authoritymanagement\\agentRelation\\index.vue","mtime":1616384580035},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.array.find-index\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _toConsumableArray from \"C:/Users/admin/Desktop/merchant-manager-web/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"C:/Users/admin/Desktop/merchant-manager-web/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport EditOpen from \"./components/EditOpen\";\nimport TableComp from \"./components/TableComp\";\nimport SelectAgentTree from '@/components/SelectAgentTree';\nimport list from '@/mixins/list';\nimport tier from '@/mixins/tier';\nimport { routerNames } from '@/utils/consts';\nimport { mapGetters } from 'vuex';\nexport default {\n  name: routerNames.agentRelation,\n  components: {\n    EditOpen: EditOpen,\n    SelectAgentTree: SelectAgentTree,\n    TableComp: TableComp\n  },\n  mixins: [list, tier],\n  data: function data() {\n    return {\n      modalType: 1,\n      // 1为启用 2位停用 3为重置密码\n      loading: false,\n      openVisible: false,\n      // model (integer): 合作模式：1、收益分成+购点，2、收益分成，3、购点 ,\n      model: 2,\n      hasSearch: false,\n      form: {\n        agentId: ''\n      },\n      downForm: {\n        time: [],\n        agentType: -1,\n        status: -1\n      },\n      currentData: {},\n      openData: {},\n      currentIndex: -1,\n      currentLevel: 1,\n      // 商户编码\n      agentCode: '',\n      parentAgentId: '',\n      agentType: '',\n      dialogShow: false,\n      show: true,\n      agentId: '',\n      storeDatas: [],\n      data: [],\n      currencyList: []\n    };\n  },\n  computed: _objectSpread({}, mapGetters(['userInfo'])),\n  watch: {\n    downForm: {\n      handler: function handler(val) {\n        this.loadData();\n      },\n      deep: true\n    }\n  },\n  methods: {\n    loadData: function loadData() {\n      var _this = this;\n\n      this.loading = true;\n      this.levels = [];\n      var form = {\n        pageSize: this.pageSize,\n        pageIndex: this.pageIndex,\n        agentId: this.form.agentId,\n        type: 1\n      };\n      this.loadCurrenyDate();\n      this.$api.agentRelation(form).then(function (_) {\n        _this.loading = false;\n\n        if (_.code === 200) {\n          var data = _.data;\n          _this.total = data.totalRecord;\n          var _list = data.record;\n          _this.tableLists = [{\n            opened: false,\n            iconLoading: false,\n            level: 1,\n            data: _list\n          }];\n        }\n      }).catch(function () {\n        _this.loading = false;\n      });\n    },\n\n    /**\r\n     * actType 1为增加 2为修改\r\n     */\n    modifyData: function modifyData(level, params, tableIndex, actType) {\n      var extraParams = {\n        startTime: this.downForm.time && this.downForm.time[0],\n        endTime: this.downForm.time && this.downForm.time[1],\n        agentType: this.downForm.agentType,\n        status: this.downForm.status,\n        agentId: params.agentId\n      };\n      this.mixinModifyData(level, params, tableIndex, actType, 'agentRelation', extraParams);\n    },\n    handleSearch: function handleSearch() {\n      var extraParams = {};\n      this.mixinHandleSearch('agentRelation', extraParams);\n    },\n    closeEdit: function closeEdit(value) {\n      var _this2 = this;\n\n      this.$store.dispatch('tree/setTree', []);\n      this.$store.dispatch('tree/setTreeData', []);\n      this.form.agentId = '';\n      this.$refs.tree.initData();\n      this.show = false;\n      setTimeout(function () {\n        _this2.show = true;\n      }, 500);\n      this.loadData();\n    },\n    generateTree: function generateTree(data) {\n      var _this3 = this;\n\n      var datas = _toConsumableArray(data); // 先找出父节点\n\n\n      datas.forEach(function (element, i) {\n        var index = data.findIndex(function (val) {\n          return val.id === element.parentId;\n        });\n\n        if (index < 0) {\n          _this3.storeDatas.push(_objectSpread({\n            id: element.id,\n            label: \"\".concat(element.agentName, \" \").concat(element.agentCode),\n            children: []\n          }, element));\n\n          datas.splice(i, 1);\n        }\n      });\n      this.recursionData(datas, this.storeDatas);\n    },\n    // 递归生成\n    recursionData: function recursionData(data, tree) {\n      var _this4 = this;\n\n      var datas = _toConsumableArray(data);\n\n      var pickIndex = [];\n      var leftDatas = [];\n      datas.forEach(function (element) {\n        var index = tree.findIndex(function (val) {\n          return val.id === element.parentId;\n        });\n\n        if (index > -1) {\n          tree[index].children.push(_objectSpread({\n            id: element.id,\n            label: \"\".concat(element.agentName, \" \").concat(element.agentCode),\n            children: []\n          }, element));\n          !pickIndex.includes(index) && pickIndex.push(index);\n        } else {\n          leftDatas.push(element);\n        }\n      });\n\n      if (pickIndex.length > 0) {\n        pickIndex.forEach(function (element) {\n          _this4.recursionData(leftDatas, tree[element].children);\n        });\n      }\n    },\n    handleReset: function handleReset() {\n      this.form = {\n        agentId: ''\n      };\n      this.hasSearch = false;\n      this.loadData();\n    },\n    editOpen: function editOpen(index, row, tableData) {\n      var _this5 = this;\n\n      this.tableLists.forEach(function (item, index) {\n        if (item.level === tableData.level) {\n          if (item.parentId) {\n            _this5.parentAgentId = item.parentId.split('_')[1];\n          } else {\n            _this5.parentAgentId = _this5.tableLists[index - 1].data[0].agentId.split('_')[1];\n          }\n        }\n      });\n      this.openData = _objectSpread({}, row);\n      this.openVisible = true;\n    },\n    loadCurrenyDate: function loadCurrenyDate() {\n      var _this6 = this;\n\n      this.$api.getCurrencyComboBoxList({\n        pageIndex: 1,\n        pageSize: 100\n      }).then(function (_) {\n        var data = _.data;\n        _this6.currencyList = data.record;\n      });\n    }\n  }\n};",null]}