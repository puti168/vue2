{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\systemmanagement\\domain\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\systemmanagement\\domain\\index.vue","mtime":1617695097439},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"C:/Users/admin/Desktop/merchant-manager-web/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapGetters } from 'vuex';\nimport list from '@/mixins/list';\nimport { IsURL } from '@/utils';\nimport { routerNames } from '@/utils/consts';\nimport SelectAgentTree from '@/components/SelectAgentTree';\nimport Modal from '@/components/Modal';\nimport dayjs from 'dayjs';\nexport default {\n  name: routerNames.systemDomain,\n  components: {\n    SelectAgentTree: SelectAgentTree,\n    Modal: Modal\n  },\n  mixins: [list],\n  data: function data() {\n    return {\n      dialogVisible: false,\n      hadSearch: false,\n      loading: false,\n      urlDialogVisible: false,\n      recordDialogVisible: false,\n      currentPage: 1,\n      form: {\n        time: '',\n        userName: '',\n        agentId: '',\n        status: -1,\n        type: -1\n      },\n      urlDialogTypeData: null,\n      urlDialogForm: {\n        agentId: '',\n        type: 1,\n        dns: ''\n      },\n      list: []\n    };\n  },\n  computed: _objectSpread(_objectSpread(_objectSpread(_objectSpread({}, mapGetters(['name'])), mapGetters(['buttonPermissions'])), mapGetters(['globalDics'])), {}, {\n    urlDialogFormRules: function urlDialogFormRules() {\n      var _this2 = this;\n\n      var validUrl = function validUrl(rule, value, callback) {\n        if (value.length > 255) {\n          callback(new Error(_this2.$t('systemmanagement_domain_index_1377')));\n        } else if (IsURL(value)) {\n          callback();\n        } else {\n          callback(new Error(_this2.$t('systemmanagement_domain_index_1378')));\n        }\n      };\n\n      return {\n        agentName: [{\n          required: true,\n          message: this.$t('systemmanagement.systemmanagement_67'),\n          trigger: 'blur'\n        }],\n        type: [{\n          required: true,\n          message: this.$t('systemmanagement.systemmanagement_28'),\n          trigger: 'change'\n        }],\n        dns: [{\n          message: this.$t('systemmanagement_domain_index_1368'),\n          trigger: 'blur',\n          required: true\n        }, {\n          validator: validUrl,\n          trigger: 'blur'\n        }]\n      };\n    },\n    pickerOptions: function pickerOptions() {\n      var _this = this;\n\n      return {\n        disabledDate: function disabledDate(time) {\n          var now = dayjs().endOf('day').valueOf();\n          return time.getTime() > now;\n        },\n        onPick: function onPick(_ref) {\n          var maxDate = _ref.maxDate,\n              minDate = _ref.minDate;\n\n          if (!maxDate) {\n            _this.minDate = minDate;\n          }\n        },\n        shortcuts: [{\n          text: this.$t(\"members_betrecord_index_584\"),\n          onClick: function onClick(picker) {\n            var end = dayjs().endOf('day');\n            var start = dayjs().startOf('day');\n            picker.$emit('pick', [+start, +end]);\n          }\n        }, {\n          text: this.$t(\"members_betrecord_index_585\"),\n          onClick: function onClick(picker) {\n            var end = dayjs().endOf('day').subtract(1, 'd');\n            var start = dayjs().startOf('day').subtract(1, 'd');\n            picker.$emit('pick', [+start, +end]);\n          }\n        }, {\n          text: this.$t(\"members_betrecord_index_586\"),\n          onClick: function onClick(picker) {\n            var start, end;\n            var weekNum = dayjs().day();\n\n            if (weekNum === 0) {\n              end = dayjs().endOf('day');\n              start = dayjs().subtract(1, 'd').startOf('week').startOf('day').add(1, 'd');\n            } else {\n              end = dayjs().endOf('day');\n              start = dayjs().startOf('day').startOf('week').add(1, 'd');\n            }\n\n            picker.$emit('pick', [+start, +end]);\n          }\n        }, {\n          text: this.$t(\"members_betrecord_index_587\"),\n          onClick: function onClick(picker) {\n            var end = dayjs().endOf('day');\n            var start = dayjs().startOf('month');\n            picker.$emit('pick', [+start, +end]);\n          }\n        }, {\n          text: this.$t(\"merchant_dailyrateaccount_index_799\"),\n          onClick: function onClick(picker) {\n            var end = dayjs().endOf('day');\n            var start = dayjs().startOf('day').subtract(89, 'd');\n            picker.$emit('pick', [+start, +end]);\n          }\n        }]\n      };\n    }\n  }),\n  methods: {\n    handleSearch: function handleSearch() {\n      this.hadSearch = true;\n      this.pageIndex = 1;\n      this.loadData();\n    },\n    handleReset: function handleReset() {\n      var end = dayjs().endOf('day').valueOf();\n      var start = dayjs().startOf('day').subtract(29, 'd').valueOf();\n      this.hadSearch = false;\n      this.form = {\n        time: [start, end],\n        agentId: ''\n      };\n      this.initList();\n    },\n    loadData: function loadData() {\n      var _this3 = this;\n\n      this.loading = true;\n      var initData = {\n        pageSize: this.pageSize,\n        pageIndex: this.pageIndex,\n        startAt: this.form.time ? this.form.time[0] : '',\n        endAt: this.form.time ? this.form.time[1] : ''\n      };\n      var requestData = this.hadSearch ? {\n        agentId: this.form.agentId\n      } : {};\n\n      var form = _objectSpread(_objectSpread({}, initData), requestData);\n\n      this.$api.agentDnsSearch(form).then(function (_) {\n        _this3.loading = false;\n        var data = _.data;\n        _this3.list = data.record;\n        _this3.total = data.totalRecord;\n      }).catch(function () {\n        _this3.loading = false;\n      });\n    },\n    // 获取选择的商户\n    getNode: function getNode(node) {\n      this.urlDialogForm.agentId = node.id;\n      this.urlDialogForm.agentName = node.agentName;\n    },\n    commitUrlDialog: function commitUrlDialog() {\n      var _this4 = this;\n\n      this.$refs.urlDialogFormRef.validate(function (_) {\n        if (_) {\n          var api = _this4.urlDialogForm.id ? 'agentDnsUpdate' : 'agentDnsSave';\n          var params = {\n            agentId: _this4.urlDialogForm.agentId,\n            agentName: _this4.urlDialogForm.agentName,\n            dns: _this4.urlDialogForm.dns,\n            id: _this4.urlDialogForm.id ? _this4.urlDialogForm.id : undefined\n          };\n\n          var loading = _this4.$loading({\n            lock: true,\n            text: 'Loading',\n            spinner: 'el-icon-loading',\n            background: 'rgba(0, 0, 0, 0.7)'\n          });\n\n          _this4.$api[api](params).then(function (res) {\n            if (res.code === 200) {\n              _this4.urlDialogVisible = false;\n\n              if (res.data === 'exist') {\n                _this4.dialogVisible = true;\n              } else {\n                _this4.$message({\n                  type: 'success',\n                  message: !_this4.urlDialogForm.id ? _this4.$t('systemmanagement_domain_index_1379') : _this4.$t('systemmanagement_domain_index_1380')\n                });\n\n                _this4.loadData();\n              }\n            }\n\n            loading.close();\n          }).catch(function () {\n            loading.close();\n          });\n        }\n      });\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.loadData();\n    },\n    onHandleCancel: function onHandleCancel() {\n      this.urlDialogVisible = false;\n      this.$refs.urlDialogFormRef.clearValidate();\n    },\n    handleNewAddress: function handleNewAddress() {\n      this.urlDialogForm = {\n        type: 1\n      };\n      this.urlDialogVisible = true;\n    },\n    editRow: function editRow(row) {\n      this.urlDialogVisible = true;\n      this.urlDialogForm = _objectSpread({}, row);\n      this.urlDialogTypeData = row;\n    },\n    querySearchAgentName: function querySearchAgentName(keywords, cb) {\n      var _this5 = this;\n\n      this.$api.systemSearchAgents({\n        keywords: keywords\n      }).then(function (_) {\n        if (_.code === 200) {\n          clearTimeout(_this5.timeout);\n          _this5.timeout = setTimeout(function () {\n            cb(_.data);\n          }, 500);\n        }\n      });\n    },\n    handleSelectAgentName: function handleSelectAgentName(item) {\n      this.urlDialogForm.agentName = item.agentName;\n      this.urlDialogForm.agentId = item.agentId;\n    }\n  }\n};",null]}