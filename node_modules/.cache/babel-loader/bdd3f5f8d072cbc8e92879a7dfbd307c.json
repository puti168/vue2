{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\merchant\\merchantInfo\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\merchant\\merchantInfo\\index.vue","mtime":1617695097426},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _toConsumableArray from \"C:/Users/admin/Desktop/merchant-manager-web/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.number.constructor\";\nimport _objectSpread from \"C:/Users/admin/Desktop/merchant-manager-web/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport NewBusiness from \"./components/NewBusiness\";\nimport EditAccount from \"./components/EditAccount\";\nimport KeysManage from \"./components/KeysManage\";\nimport EditTrial from \"./components/EditTrial\";\nimport Setting from \"./components/Setting\";\nimport EditOpen from \"./components/EditOpen\";\nimport TableComp from \"./components/TableComp\";\nimport SelectAgentTree from '@/components/SelectAgentTree';\nimport Modal from '@/components/Modal';\nimport list from '@/mixins/list';\nimport tier from '@/mixins/tier';\nimport { routerNames } from '@/utils/consts';\nimport { mapGetters } from 'vuex';\nexport default {\n  name: routerNames.merchantmerchantmanage,\n  components: {\n    KeysManage: KeysManage,\n    EditAccount: EditAccount,\n    NewBusiness: NewBusiness,\n    EditTrial: EditTrial,\n    Setting: Setting,\n    EditOpen: EditOpen,\n    Modal: Modal,\n    SelectAgentTree: SelectAgentTree,\n    TableComp: TableComp\n  },\n  mixins: [list, tier],\n  data: function data() {\n    return {\n      modalType: 1,\n      // 1为启用 2位停用 3为重置密码\n      loading: false,\n      editAccountVisible: false,\n      keysVisible: false,\n      trialVisible: false,\n      show: true,\n      settingVisible: false,\n      openVisible: false,\n      // model (integer): 合作模式:1、收益分成+购点，2、收益分成，3、购点 ,\n      model: 2,\n      hasSearch: false,\n      merchantData: {},\n      drawer: false,\n      businessType: 1,\n      // 新增商户类型\n      businessDrawer: false,\n      dialogVisible: false,\n      lockVisible: false,\n      md5: {},\n      form: {\n        agentId: ''\n      },\n      downForm: {\n        time: [],\n        agentType: -1,\n        status: -1,\n        activeStatus: -1,\n        walletType: '',\n        merchantType: ''\n      },\n      currentData: {},\n      openData: {},\n      currentIndex: -1,\n      currentLevel: 1,\n      // 商户编码\n      agentCode: '',\n      // 谷歌秘钥\n      googleAuthCode: '',\n      platformAgent: 1,\n      agentType: '',\n      dialogShow: false,\n      agentsLevel: '',\n      apiRate: 0,\n      countPercentage: 0,\n      agentId: '',\n      currencyId: '',\n      cooperationModel: 0,\n      topAgent: {},\n      currencyList: [],\n      createLevel: ''\n    };\n  },\n  computed: _objectSpread(_objectSpread({}, mapGetters(['userInfo'])), {}, {\n    modalTitle: function modalTitle() {\n      var text;\n\n      switch (this.modalType) {\n        case 1:\n          text = this.$t('merchant_merchantinfo_index_1131');\n          break;\n\n        case 2:\n          text = this.$t('merchant_merchantinfo_index_1132');\n          break;\n\n        default:\n          text = this.$t('merchant_merchantinfo_index_1133');\n      }\n\n      return text;\n    }\n  }),\n  watch: {\n    downForm: {\n      handler: function handler(val) {\n        this.loadData();\n      },\n      deep: true\n    }\n  },\n  methods: {\n    loadData: function loadData() {\n      var _this = this;\n\n      this.loading = true;\n      this.levels = [];\n      var form = {\n        pageSize: this.pageSize,\n        pageIndex: this.pageIndex,\n        agentId: this.form.agentId,\n        type: 1\n      };\n      this.loadCurrenyDate();\n      this.$api.searchAgentList(form).then(function (_) {\n        _this.loading = false;\n\n        if (_.code === 200) {\n          var data = _.data;\n          _this.total = data.totalRecord;\n          var _list = data.record;\n          _this.topAgent = _list[0];\n          _this.tableLists = [{\n            opened: false,\n            iconLoading: false,\n            level: 1,\n            data: _list\n          }];\n        }\n      }).catch(function () {\n        _this.loading = false;\n      });\n    },\n\n    /**\r\n     * actType 1为增加 2为修改\r\n     */\n    modifyData: function modifyData(level, params, tableIndex, actType) {\n      var extraParams = {\n        startAt: this.downForm.time && this.downForm.time[0],\n        endAt: this.downForm.time && this.downForm.time[1],\n        agentType: this.downForm.agentType,\n        status: this.downForm.status,\n        activeStatus: this.downForm.activeStatus,\n        agentId: params.agentId\n      };\n\n      if (this.hasPermission(12117)) {\n        extraParams.walletType = this.downForm.walletType;\n      }\n\n      if (this.hasPermission(12116)) {\n        extraParams.merchantType = this.downForm.merchantType;\n      }\n\n      this.mixinModifyData(level, params, tableIndex, actType, 'searchAgentList', extraParams);\n    },\n    handleSearch: function handleSearch() {\n      var extraParams = {};\n      this.mixinHandleSearch('searchAgentList', extraParams);\n    },\n    handleReset: function handleReset() {\n      this.form = {\n        agentId: ''\n      };\n      this.hasSearch = false;\n      this.loadData();\n    },\n    handleNewBusiness: function handleNewBusiness(type, level, createLevel, apiRate, agentId, currency, countPercentage, cooperationModel, agentType, availableAccountLimit, platformAgent) {\n      var _this2 = this;\n\n      if (this.userInfo.agentCode !== 'AAAAA' && Number(this.topAgent.availableAccountLimit) === 0 && createLevel === 'top') {\n        this.$message({\n          type: 'error',\n          message: this.$t('backstage_200214')\n        });\n        return;\n      }\n\n      if (JSON.stringify(this.topAgent) === '{}') {\n        return;\n      }\n\n      this.dialogShow = true;\n      this.$nextTick(function () {\n        _this2.businessDrawer = true;\n        _this2.businessType = type;\n        _this2.agentsLevel = level;\n        _this2.createLevel = createLevel;\n        _this2.apiRate = apiRate;\n        _this2.agentId = agentId;\n        _this2.agentType = agentType;\n        _this2.platformAgent = createLevel === 'top' ? _this2.userInfo.platformAgent : platformAgent;\n        _this2.currencyId = currency ? currency + '' : _this2.topAgent.currency + '' || '1';\n        _this2.countPercentage = countPercentage;\n        _this2.cooperationModel = cooperationModel || _this2.topAgent.cooperationModel; // 获取商户编码\n\n        _this2.$api.getAgentCode().then(function (res) {\n          if (res.code === 200) {\n            _this2.agentCode = res.data;\n\n            _this2.$api.createWalletMd5key({\n              agentCode: res.data\n            }).then(function (_) {\n              _this2.md5 = _.data;\n            }).catch(function () {});\n          }\n        }); // 获取谷歌验证码\n\n\n        _this2.$api.getGoogleAuth().then(function (res) {\n          if (res.code === 200) {\n            _this2.googleAuthCode = res.data;\n          }\n        });\n      });\n    },\n    resetPassword: function resetPassword(row) {\n      this.currentData = _objectSpread({}, row);\n      this.dialogVisible = true;\n      this.modalType = 3;\n    },\n    editAccountInfo: function editAccountInfo(index, row, type, level) {\n      this.currentData = _objectSpread(_objectSpread({}, row), {}, {\n        type: type\n      });\n      this.currentIndex = index;\n      this.currentLevel = level;\n      this.editAccountVisible = true;\n    },\n    editSuccess: function editSuccess(form) {\n      // 因为这里是未来生效的，所以还是要显示当前的\n      if (form.countPercentage) delete form.countPercentage;\n      if (form.rateSharingEffectiveDate) delete form.rateSharingEffectiveDate;\n      if (form.apiRate) delete form.apiRate;\n      if (form.buyCreditsEffectiveDate) delete form.buyCreditsEffectiveDate;\n      this.tableLists[this.currentLevel - 1].data[this.currentIndex] = _objectSpread(_objectSpread({}, this.currentData), form);\n      this.tableLists = JSON.parse(JSON.stringify(this.tableLists));\n    },\n    editTrialInfo: function editTrialInfo(index, row, level) {\n      this.currentData = _objectSpread({}, row);\n      this.currentIndex = index;\n      this.currentLevel = level;\n      this.trialVisible = true;\n    },\n    setting: function setting(index, row, level) {\n      this.currentData = _objectSpread({}, row);\n      this.currentIndex = index;\n      this.currentLevel = level;\n      this.settingVisible = true;\n    },\n    editOpen: function editOpen(index, row, level) {\n      this.openData = _objectSpread({}, row);\n      this.openVisible = true;\n    },\n    closeEdit: function closeEdit() {\n      this.handleSearch();\n    },\n    // 静态更新试玩配置\n    editTrialInfoSuccess: function editTrialInfoSuccess(value) {\n      this.tableLists[this.currentLevel - 1].data[this.currentIndex] = _objectSpread(_objectSpread({}, this.currentData), value);\n      this.tableLists[this.currentLevel - 1].data = _toConsumableArray(this.tableLists[this.currentLevel - 1].data);\n      this.tableLists = _toConsumableArray(this.tableLists);\n    },\n    settingSuccess: function settingSuccess(value) {\n      if (value) {\n        this.tableLists[this.currentLevel - 1].data[this.currentIndex] = _objectSpread(_objectSpread(_objectSpread({}, this.currentData), value), {}, {\n          activeStatus: 1\n        });\n      }\n\n      this.tableLists[this.currentLevel - 1].data = _toConsumableArray(this.tableLists[this.currentLevel - 1].data);\n      this.tableLists = _toConsumableArray(this.tableLists);\n    },\n    showKeysManage: function showKeysManage(row) {\n      this.currentData = _objectSpread({}, row);\n      this.keysVisible = true;\n    },\n    editAgentStatus: function editAgentStatus(index, row, level) {\n      this.currentData = _objectSpread({}, row);\n      this.currentIndex = index;\n      this.currentLevel = level;\n      this.dialogVisible = true;\n      this.modalType = row.status === 1 ? 2 : 1;\n    },\n    Unlock: function Unlock(index, row, level) {\n      this.currentData = _objectSpread({}, row);\n      this.currentIndex = index;\n      this.currentLevel = level;\n      this.lockVisible = true;\n      this.modalType = row.status === 1 ? 2 : 1;\n    },\n    handleSure: function handleSure() {\n      var _this3 = this;\n\n      // 重置管理员密码\n      if (this.modalType === 3) {\n        this.$api.resetAdminPwd({\n          agentId: this.currentData.agentId,\n          agentName: this.currentData.agentName,\n          agentCode: this.currentData.agentCode\n        }).then(function (res) {\n          if (res.code === 200) {\n            _this3.dialogVisible = false;\n            return _this3.$message({\n              type: 'success',\n              message: _this3.$t('merchant_merchantinfo_index_1134')\n            });\n          }\n        });\n      } else {\n        var params = {\n          agentId: this.currentData.agentId,\n          agentName: this.currentData.agentName,\n          status: this.currentData.status === 1 ? 0 : 1\n        };\n        this.$api.merchantUpdateStatus(params).then(function (res) {\n          if (res.code === 200) {\n            _this3.tableLists[_this3.currentLevel - 1].data[_this3.currentIndex].status = params.status;\n            _this3.tableLists = _toConsumableArray(_this3.tableLists);\n            _this3.dialogVisible = false;\n          }\n        });\n      }\n    },\n    handleSureLock: function handleSureLock() {\n      var _this4 = this;\n\n      var params = {\n        userId: this.currentData.userId\n      };\n      this.$api.unLockUser(params).then(function (res) {\n        if (res.code === 200) {\n          _this4.tableLists[_this4.currentLevel - 1].data[_this4.currentIndex].lockFlag = 0;\n          _this4.tableLists = _toConsumableArray(_this4.tableLists);\n          _this4.lockVisible = false;\n\n          _this4.$message({\n            message: _this4.$t('merchant_merchantinfo_components_keysmanage_1004'),\n            type: 'success'\n          });\n        }\n      });\n    },\n    closeNew: function closeNew(value) {\n      var _this5 = this;\n\n      this.$store.dispatch('tree/setTree', []);\n      this.$store.dispatch('tree/setTreeData', []);\n      this.form.agentId = '';\n      this.$refs.tree.initData();\n      this.show = false;\n      setTimeout(function () {\n        _this5.show = true;\n      }, 500);\n      this.loadData();\n    },\n    updateDialog: function updateDialog() {\n      this.agentsLevel = '';\n      this.createLevel = '';\n      this.apiRate = 0;\n      this.countPercentage = 0;\n      this.agentId = '';\n      this.currencyId = '';\n      this.dialogShow = false;\n      this.cooperationModel = 0;\n    },\n    loadCurrenyDate: function loadCurrenyDate() {\n      var _this6 = this;\n\n      this.$api.getCurrencyComboBoxList({\n        pageIndex: 1,\n        pageSize: 100\n      }).then(function (_) {\n        var data = _.data;\n        _this6.currencyList = data.record;\n      });\n    }\n  }\n};",null]}