{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\systemmanagement\\currency\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\systemmanagement\\currency\\index.vue","mtime":1617695097438},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:/Users/admin/Desktop/merchant-manager-web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"C:/Users/admin/Desktop/merchant-manager-web/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport list from '@/mixins/list';\nimport { mapGetters } from 'vuex';\nimport { routerNames } from '@/utils/consts';\nimport { generateTitle } from '@/utils/i18n';\nimport { decimalValidateSix } from '@/utils/validate';\nexport default {\n  name: routerNames.systemCurrency,\n  mixins: [list],\n  data: function data() {\n    return {\n      hadSearch: false,\n      loading: false,\n      releaseTime: '',\n      form: {\n        id: -1\n      },\n      urlDialogVisible: false,\n      urlDialogForm: {\n        agentName: '',\n        type: '',\n        url: '',\n        desc: ''\n      },\n      userNames: [],\n      currencyForm: {\n        code: '',\n        name: '',\n        currencyRate: ''\n      },\n      ipDialogVisible: false,\n      isEdit: true,\n      currentRow: {}\n    };\n  },\n  computed: _objectSpread(_objectSpread({}, mapGetters(['globalDics'])), {}, {\n    ipDialogRules: function ipDialogRules() {\n      var _this = this;\n\n      /* eslint-disable */\n      var validateName = /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(rule, value, callback) {\n          return regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  if (!/^[a-zA-Z0-9\\u4e00-\\u9fa5]+$/.test(value)) {\n                    callback(new Error(_this.$t('systemmanagement_currency_index_16')));\n                  } else if (value.length > 20) {\n                    callback(new Error(_this.$t('systemmanagement_parameter_index_25')));\n                  } else if (value.length < 2) {\n                    callback(new Error(_this.$t('systemmanagement_parameter_index_26')));\n                  } else {\n                    callback();\n                  }\n\n                case 1:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function validateName(_x, _x2, _x3) {\n          return _ref.apply(this, arguments);\n        };\n      }();\n      /* eslint-disable */\n\n\n      var validateCode = /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(rule, value, callback) {\n          return regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  if (!/^[A-Z]{3}$/.test(value)) {\n                    callback(new Error(_this.$t('systemmanagement_currency_index_78')));\n                  } else {\n                    callback();\n                  }\n\n                case 1:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2);\n        }));\n\n        return function validateCode(_x4, _x5, _x6) {\n          return _ref2.apply(this, arguments);\n        };\n      }();\n\n      var currencyRateValidate = function currencyRateValidate(rule, value, callback) {\n        if (!decimalValidateSix(value)) {\n          callback(new Error(_this.$t('systemmanagement_currency_index_77')));\n        } else if (value === 0 || value === '0') {\n          callback(new Error(_this.$t('systemmanagement_currency_index_81')));\n        } else if (value < 0 || value > 10000) {\n          callback(new Error(_this.$t('systemmanagement_currency_index_82')));\n        } else {\n          callback();\n        }\n      };\n\n      return {\n        name: [{\n          required: true,\n          message: this.$t('systemmanagement_currency_index_1343'),\n          trigger: 'blur'\n        }, {\n          validator: validateName,\n          trigger: 'blur'\n        }],\n        code: [{\n          required: true,\n          message: this.$t('systemmanagement_currency_index_1344'),\n          trigger: 'blur'\n        }, {\n          validator: validateCode,\n          trigger: 'blur'\n        }],\n        currencyRate: [{\n          required: true,\n          validator: currencyRateValidate,\n          trigger: 'blur'\n        }]\n      };\n    }\n  }),\n  watch: {// 'currencyForm.currencyRate'(val) {\n    // \tif (val === 0 || val === '0') {\n    // \t\tthis.currencyForm.currencyRate = ''\n    // \t}\n    // },\n  },\n  created: function created() {\n    var _this2 = this;\n\n    // 获取操作账号\n    this.$api.listUsername().then(function (res) {\n      if (res.code === 200) {\n        _this2.userNames = res.data;\n      }\n    });\n  },\n  mounted: function mounted() {\n    var _this3 = this;\n\n    this.itemtimer = setInterval(function () {\n      var items = document.querySelectorAll('.el-form-item__error');\n      items.forEach(function (i) {\n        if (i.innerHTML.includes(_this3.$t('systemmanagement_currency_index_16'))) {\n          i.innerHTML = _this3.$t('systemmanagement_currency_index_16');\n        }\n\n        if (i.innerHTML.includes(_this3.$t('systemmanagement_currency_index_17'))) {\n          i.innerHTML = _this3.$t('systemmanagement_currency_index_17');\n        }\n\n        if (i.innerHTML.includes('输入3个大写英文字符')) {\n          if (/^[A-Z]{3}$/.test(_this3.currencyForm.code)) {\n            i.style.opacity = '0';\n            return;\n          }\n\n          var elem = document.createElement('div');\n          elem.className = 'el-form-item__error';\n          elem.innerHTML = '输入3个大写英文字符';\n          i.parentElement.replaceChild(elem, i);\n        }\n\n        if (i.innerHTML.includes('Enter 3 uppercase English characters')) {\n          if (/^[A-Z]{3}$/.test(_this3.currencyForm.code)) {\n            i.style.opacity = '0';\n            return;\n          }\n\n          var _elem = document.createElement('div');\n\n          _elem.className = 'el-form-item__error';\n          _elem.innerHTML = 'Enter 3 uppercase English characters';\n          i.parentElement.replaceChild(_elem, i);\n        }\n\n        if (i.innerHTML.includes(_this3.$t('systemmanagement_currency_index_1344'))) {\n          i.innerText = ' ' + _this3.$t('systemmanagement_currency_index_1344');\n        }\n      });\n    }, 1000);\n  },\n  destroyed: function destroyed() {\n    this.itemtimer = null;\n    window.clearInterval(this.itemtimer);\n  },\n  methods: {\n    renderInfo: function renderInfo(modifys, item) {\n      var newValue;\n\n      if (item.includes(this.$t('systemmanagement_currency_index_1349'))) {\n        newValue = [];\n        modifys && modifys.map(function (val) {\n          return newValue.push(generateTitle(val));\n        });\n      } else {\n        newValue = modifys;\n      }\n\n      return newValue;\n    },\n    hadChangeColor: function hadChangeColor(pre, next) {\n      if (JSON.stringify(pre) !== JSON.stringify(next)) {\n        return 'change-color';\n      }\n    },\n    loadData: function loadData() {\n      var _this4 = this;\n\n      this.loading = true;\n      var initData = {\n        pageIndex: this.pageIndex,\n        pageSize: this.pageSize\n      };\n      var requestData = this.hadSearch ? {\n        id: this.form.id\n      } : {};\n\n      var form = _objectSpread(_objectSpread({}, initData), requestData);\n\n      this.$api.getCurrencyList(form).then(function (_) {\n        _this4.loading = false;\n        var data = _.data;\n        _this4.list = data.record;\n        _this4.total = data.totalRecord;\n      }).catch(function () {\n        _this4.loading = false;\n      });\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.loadData();\n    },\n    handleReset: function handleReset() {\n      this.form = {\n        id: -1\n      };\n      this.hadSearch = false;\n      this.initList();\n    },\n    handleSearch: function handleSearch() {\n      this.hadSearch = true;\n      this.pageIndex = 1;\n      this.loadData();\n    },\n    editRow: function editRow(row) {\n      this.currentRow = row;\n      this.isEdit = true;\n      this.ipDialogVisible = true;\n      this.currencyForm = {\n        code: row.code,\n        name: row.name,\n        currencyRate: row.currencyRate\n      };\n    },\n    stopRow: function stopRow(index, rows) {\n      rows.splice(index, 1);\n    },\n    handleCreateWhite: function handleCreateWhite() {\n      this.isEdit = false;\n      this.ipDialogVisible = true;\n      this.currencyForm = {\n        code: '',\n        name: '',\n        currencyRate: ''\n      };\n    },\n    onCancel: function onCancel() {\n      this.ipDialogVisible = false;\n      this.$refs.currencyFormRef.clearValidate();\n    },\n    commitIpDialog: function commitIpDialog() {\n      var _this5 = this;\n\n      this.$refs.currencyFormRef.validate(function (val) {\n        if (val) {\n          var form = _this5.isEdit ? {\n            name: _this5.currencyForm.name,\n            code: _this5.currencyForm.code,\n            currencyRate: _this5.currencyForm.currencyRate,\n            id: _this5.currentRow.id\n          } : {\n            name: _this5.currencyForm.name,\n            code: _this5.currencyForm.code,\n            currencyRate: _this5.currencyForm.currencyRate\n          };\n          var api = _this5.isEdit ? 'editCurrency' : 'addCurrency';\n          var text = _this5.isEdit ? _this5.$t('systemmanagement_currency_index_1341') : _this5.$t('systemmanagement_currency_index_1350');\n\n          var loading = _this5.$loading({\n            lock: true,\n            text: 'Loading',\n            spinner: 'el-icon-loading',\n            background: 'rgba(0, 0, 0, 0.7)'\n          });\n\n          _this5.$api[api](form).then(function () {\n            _this5.ipDialogVisible = false;\n\n            _this5.$message({\n              type: 'success',\n              message: _this5.$t('systemmanagement_currency_index_1351', [text])\n            });\n\n            _this5.loadData();\n\n            loading.close();\n          }).catch(function () {\n            loading.close();\n          });\n        }\n      });\n    }\n  }\n};",null]}