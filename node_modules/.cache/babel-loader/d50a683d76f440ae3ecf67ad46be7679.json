{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\components\\MerchantSelector\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\components\\MerchantSelector\\index.vue","mtime":1617594855289},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzovVXNlcnMvYWRtaW4vRGVza3RvcC9tZXJjaGFudC1tYW5hZ2VyLXdlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCB7IFN0b3JlTWl4aW4gfSBmcm9tICdAL2NvcmUvbWl4aW5zJzsKaW1wb3J0IHsgZ2V0TWVyY2hhbnRUcmVlLCBnZXRNZXJjaGFudFJvb3RUcmVlIH0gZnJvbSAnQC9hcGkvbWVyY2hhbnQvbGlzdCc7CmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogewogICAgZ2FtZVR5cGU6IHsKICAgICAgdHlwZTogU3RyaW5nCiAgICB9LAogICAgZm9yUGFyZW50OiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgYWxsb3dDbGVhcjogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6IFN0cmluZwogICAgfSwKICAgIGFwaTogewogICAgICB0eXBlOiBGdW5jdGlvbiwKICAgICAgZGVmYXVsdDogZ2V0TWVyY2hhbnRUcmVlCiAgICB9LAogICAgcXVlcnk6IHsKICAgICAgdHlwZTogT2JqZWN0LAogICAgICBkZWZhdWx0OiBmdW5jdGlvbiBfZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4ge307CiAgICAgIH0KICAgIH0sCiAgICBwbGFjZWhvbGRlcjogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICfovpPlhaXllYbmiLflkI3np7DmiJbkuIvmi4npgInmi6knCiAgICB9CiAgfSwKICBtaXhpbnM6IFtTdG9yZU1peGluXSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdHJlZURhdGE6IFtdLAogICAgICBzZWxlY3RlZFZhbHVlOiB1bmRlZmluZWQKICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5sb2FkRGF0YSh0cnVlKTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBleHRyYVByb3BzOiBmdW5jdGlvbiBleHRyYVByb3BzKCkgewogICAgICB2YXIgZGVmYXVsdEV4cGFuZGVkS2V5cyA9IHt9OwoKICAgICAgaWYgKHRoaXMudHJlZURhdGEubGVuZ3RoID4gMCkgewogICAgICAgIGRlZmF1bHRFeHBhbmRlZEtleXMgPSB7CiAgICAgICAgICB0cmVlRGVmYXVsdEV4cGFuZGVkS2V5czogW3RoaXMudHJlZURhdGFbMF0udW5pdGVNZXJOdW1dCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgdGhpcy4kYXR0cnMpLCBkZWZhdWx0RXhwYW5kZWRLZXlzKTsKICAgIH0sCiAgICB1c2VDYWNoZTogZnVuY3Rpb24gdXNlQ2FjaGUoKSB7CiAgICAgIHJldHVybiAhKHRoaXMucXVlcnkgJiYgdGhpcy5mb3JQYXJlbnQpOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgY2hhbmdlOiBmdW5jdGlvbiBjaGFuZ2UodmFsdWUpIHsKICAgICAgdGhpcy5zZWxlY3RlZFZhbHVlID0gdmFsdWU7CiAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JywgdmFsdWUpOwogICAgfSwKICAgIGxvYWREYXRhOiBmdW5jdGlvbiBsb2FkRGF0YShpbml0KSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoaW5pdCAmJiB0aGlzLnVzZUNhY2hlICYmIHRoaXMuZ2V0VXNlckluZm8oJ21lcmNoYW50cycpKSB7CiAgICAgICAgdGhpcy50cmVlRGF0YSA9IHRoaXMuZ2V0VXNlckluZm8oJ21lcmNoYW50cycpOwogICAgICAgIHRoaXMuc2VsZWN0ZWRWYWx1ZSA9IHRoaXMuZ2V0VmFsdWUoaW5pdCk7CiAgICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCB0aGlzLnNlbGVjdGVkVmFsdWUpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHBhcmFtID0gX29iamVjdFNwcmVhZCh7fSwgdGhpcy5xdWVyeSk7CgogICAgICBpZiAodGhpcy5nYW1lVHlwZSkgewogICAgICAgIHBhcmFtID0gX29iamVjdFNwcmVhZCh7CiAgICAgICAgICBkYXRhU291cmNlczogdGhpcy5nYW1lVHlwZQogICAgICAgIH0sIHBhcmFtKTsKICAgICAgfQoKICAgICAgdmFyIHJlcXVlc3QgPSB0aGlzLmFwaTsKCiAgICAgIGlmICh0aGlzLmZvclBhcmVudCkgewogICAgICAgIHJlcXVlc3QgPSBnZXRNZXJjaGFudFJvb3RUcmVlOwogICAgICB9CgogICAgICByZXF1ZXN0KHBhcmFtKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpcy50cmVlRGF0YSA9IHJlcy5kYXRhIHx8IFtdOwoKICAgICAgICBpZiAoX3RoaXMudXNlQ2FjaGUpIHsKICAgICAgICAgIF90aGlzLnNldFVzZXJJbmZvKCdtZXJjaGFudHMnLCBfdGhpcy50cmVlRGF0YSk7CiAgICAgICAgfQoKICAgICAgICBfdGhpcy5zZWxlY3RlZFZhbHVlID0gX3RoaXMuZ2V0VmFsdWUoaW5pdCk7CgogICAgICAgIF90aGlzLiRlbWl0KCdpbnB1dCcsIF90aGlzLnNlbGVjdGVkVmFsdWUpOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRWYWx1ZTogZnVuY3Rpb24gZ2V0VmFsdWUoaW5pdCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGlmIChpbml0KSB7CiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWU7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnRyZWVEYXRhLnNvbWUoZnVuY3Rpb24gKHYpIHsKICAgICAgICByZXR1cm4gdi51bml0ZU1lck51bSA9PSBfdGhpczIudmFsdWU7CiAgICAgIH0pKSB7CiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWU7CiAgICAgIH0KCiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHZhbCkgewogICAgICB0aGlzLnNlbGVjdGVkVmFsdWUgPSB2YWw7CiAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JywgdmFsKTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <a-tree-select\r\n    v-bind=\"extraProps\"\r\n    style=\"width: 100%\"\r\n    :dropdown-style=\"{ maxHeight: '400px', overflow: 'auto' }\"\r\n    :tree-data=\"treeData\"\r\n    :value=\"selectedValue\"\r\n    :allowClear=\"allowClear\"\r\n    show-search\r\n    treeNodeFilterProp=\"title\"\r\n    :placeholder=\"placeholder\"\r\n    :replaceFields=\"{ children: 'childList', key: 'uniteMerNum', value: 'uniteMerNum', title: 'uniteMerName' }\"\r\n    @change=\"change\"\r\n  >\r\n  </a-tree-select>\r\n</template>\r\n\r\n<script>\r\nimport { StoreMixin } from '@/core/mixins'\r\nimport { getMerchantTree, getMerchantRootTree } from '@/api/merchant/list'\r\nexport default {\r\n  props: {\r\n    gameType: {\r\n      type: String,\r\n    },\r\n    forParent: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    allowClear: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    value: {\r\n      type: String,\r\n    },\r\n    api: {\r\n      type: Function,\r\n      default: getMerchantTree,\r\n    },\r\n    query: {\r\n      type: Object,\r\n      default: () => ({}),\r\n    },\r\n    placeholder: {\r\n      type: String,\r\n      default: '输入商户名称或下拉选择',\r\n    },\r\n  },\r\n  mixins: [StoreMixin],\r\n  data() {\r\n    return {\r\n      treeData: [],\r\n      selectedValue: undefined,\r\n    }\r\n  },\r\n  created() {\r\n    this.loadData(true)\r\n  },\r\n  computed: {\r\n    extraProps() {\r\n      let defaultExpandedKeys = {}\r\n      if (this.treeData.length > 0) {\r\n        defaultExpandedKeys = { treeDefaultExpandedKeys: [this.treeData[0].uniteMerNum] }\r\n      }\r\n      return { ...this.$attrs, ...defaultExpandedKeys }\r\n    },\r\n    useCache() {\r\n      return !(this.query && this.forParent)\r\n    },\r\n  },\r\n  methods: {\r\n    change: function (value) {\r\n      this.selectedValue = value\r\n      this.$emit('input', value)\r\n    },\r\n    loadData(init) {\r\n      if (init && this.useCache && this.getUserInfo('merchants')) {\r\n        this.treeData = this.getUserInfo('merchants')\r\n        this.selectedValue = this.getValue(init)\r\n        this.$emit('input', this.selectedValue)\r\n        return\r\n      }\r\n      let param = { ...this.query }\r\n      if (this.gameType) {\r\n        param = { dataSources: this.gameType, ...param }\r\n      }\r\n      let request = this.api\r\n      if (this.forParent) {\r\n        request = getMerchantRootTree\r\n      }\r\n      request(param).then((res) => {\r\n        this.treeData = res.data || []\r\n        if (this.useCache) {\r\n          this.setUserInfo('merchants', this.treeData)\r\n        }\r\n        this.selectedValue = this.getValue(init)\r\n        this.$emit('input', this.selectedValue)\r\n      })\r\n    },\r\n    getValue(init) {\r\n      if (init) {\r\n        return this.value\r\n      }\r\n      if (this.treeData.some((v) => v.uniteMerNum == this.value)) {\r\n        return this.value\r\n      }\r\n      return undefined\r\n    },\r\n  },\r\n  watch: {\r\n    value(val) {\r\n      this.selectedValue = val\r\n      this.$emit('input', val)\r\n    },\r\n  },\r\n}\r\n</script>"],"sourceRoot":"src/components/MerchantSelector"}]}