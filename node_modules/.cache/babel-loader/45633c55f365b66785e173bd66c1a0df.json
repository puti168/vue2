{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\systemmanagement\\businessadress\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\systemmanagement\\businessadress\\index.vue","mtime":1617695097438},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.find-index\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.array.find\";\nimport _objectSpread from \"C:/Users/admin/Desktop/merchant-manager-web/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapGetters } from 'vuex';\nimport list from '@/mixins/list';\nimport { IsURL } from '@/utils';\nimport { routerNames } from '@/utils/consts';\nimport SelectAgentTree from '@/components/SelectAgentTree';\nimport { message } from '@/utils/message';\nimport Cookies from 'js-cookie';\nexport default {\n  name: routerNames.systemUrl,\n  components: {\n    SelectAgentTree: SelectAgentTree\n  },\n  mixins: [list],\n  data: function data() {\n    return {\n      hadSearch: false,\n      loading: false,\n      urlDialogVisible: false,\n      recordDialogVisible: false,\n      currentPage: 1,\n      form: {\n        agentId: '',\n        status: -1,\n        type: -1\n      },\n      urlDialogForm: {\n        agentId: '',\n        type: 1,\n        url: ''\n      },\n      list: []\n    };\n  },\n  computed: _objectSpread(_objectSpread(_objectSpread(_objectSpread({}, mapGetters(['name'])), mapGetters(['buttonPermissions'])), mapGetters(['globalDics'])), {}, {\n    urltype: function urltype() {\n      var types = this.globalDics.urltype || [];\n      return types.map(function (item) {\n        return {\n          value: item.value,\n          label: item.text,\n          zh: item.text,\n          en: item.englishText\n        };\n      });\n    },\n    urlDialogFormRules: function urlDialogFormRules() {\n      var _this = this;\n\n      var validUrl = function validUrl(rule, value, callback) {\n        if (value.length > 255) {\n          callback(new Error(_this.$t('systemmanagement_businessadress_index_1327')));\n        } else if (IsURL(value)) {\n          callback();\n        } else {\n          callback(new Error(_this.$t('systemmanagement_businessadress_index_1328')));\n        }\n      };\n\n      return {\n        agentName: [{\n          required: true,\n          message: this.$t('systemmanagement.systemmanagement_67'),\n          trigger: 'blur'\n        }],\n        type: [{\n          required: true,\n          message: this.$t('systemmanagement.systemmanagement_28'),\n          trigger: 'change'\n        }],\n        url: [{\n          message: this.$t('systemmanagement_businessadress_index_1322'),\n          trigger: 'blur',\n          required: true\n        }, {\n          validator: validUrl,\n          trigger: 'blur'\n        }]\n      };\n    }\n  }),\n  methods: {\n    handleSearch: function handleSearch() {\n      this.hadSearch = true;\n      this.pageIndex = 1;\n      this.loadData();\n    },\n    handleReset: function handleReset() {\n      this.hadSearch = false;\n      this.form = {\n        type: -1,\n        status: -1,\n        agentId: ''\n      };\n      this.initList();\n    },\n    open: function open(url) {\n      window.open(url);\n    },\n    loadData: function loadData() {\n      var _this2 = this;\n\n      this.loading = true;\n      var initData = {\n        pageSize: this.pageSize,\n        pageIndex: this.pageIndex\n      };\n      var requestData = this.hadSearch ? {\n        agentId: this.form.agentId,\n        type: this.form.type,\n        status: this.form.status\n      } : {};\n\n      var form = _objectSpread(_objectSpread({}, initData), requestData);\n\n      this.$api.systemGetAgentConfig(form).then(function (_) {\n        _this2.loading = false;\n        var data = _.data;\n        _this2.list = data.record;\n        _this2.total = data.totalRecord;\n      }).catch(function () {\n        _this2.loading = false;\n      });\n    },\n    filterUrlType: function filterUrlType(c) {\n      var arr = this.urltype || [];\n      var find = arr.find(function (item) {\n        return Number(item.value) === Number(c);\n      });\n\n      if (Cookies.get('language') === 'zh') {\n        return find && find.zh || '-';\n      }\n\n      if (Cookies.get('language') === 'en') {\n        return find && find.en || '-';\n      }\n\n      return '-';\n    },\n    commitUrlDialog: function commitUrlDialog() {\n      var _this3 = this;\n\n      this.$refs.urlDialogForm.validate(function (_) {\n        if (_) {\n          var loading = _this3.$loading({\n            lock: true,\n            text: 'Loading',\n            spinner: 'el-icon-loading',\n            background: 'rgba(0, 0, 0, 0.7)'\n          });\n\n          if (_this3.urlDialogForm.id) {\n            _this3.$api.systemEditAgentConfig(_objectSpread({}, _this3.urlDialogForm)).then(function (_) {\n              _this3.urlDialogVisible = false;\n\n              if (_.code === 200) {\n                message({\n                  type: 'success',\n                  message: _this3.$t('systemmanagement_businessadress_index_1329', [_this3.filterUrlType(_this3.urlDialogForm.type)])\n                });\n\n                _this3.loadData();\n              }\n\n              loading.close();\n            }).catch(function () {\n              loading.close();\n            });\n          } else {\n            _this3.$api.systemAddUrl(_this3.urlDialogForm).then(function (_) {\n              if (_.code === 200) {\n                _this3.urlDialogVisible = false;\n                message({\n                  type: 'success',\n                  message: _this3.$t('systemmanagement_businessadress_index_1330', [_this3.filterUrlType(_this3.urlDialogForm.type)])\n                });\n\n                _this3.loadData();\n\n                loading.close();\n              }\n            }).catch(function () {\n              loading.close();\n            });\n          }\n        }\n      });\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      console.log(this.$t('systemmanagement.systemmanagement_16', [val]));\n      this.loadData();\n    },\n    onHandleCancel: function onHandleCancel() {\n      this.urlDialogVisible = false;\n      this.$refs.urlDialogForm.clearValidate();\n    },\n    handleNewAddress: function handleNewAddress() {\n      this.urlDialogForm = {\n        type: 1\n      };\n      this.urlDialogVisible = true;\n    },\n    editRow: function editRow(row) {\n      this.urlDialogVisible = true;\n      this.urlDialogForm = _objectSpread({}, row);\n    },\n    switchChange: function switchChange(val, row) {\n      var _this4 = this;\n\n      var params = {\n        agentName: row.agentName,\n        id: row.id,\n        status: val ? '1' : '0'\n      };\n      this.$api.systemUpdateAgentUrlStatus(params).then(function (res) {\n        if (res.code === 200) {\n          var index = _this4.list.findIndex(function (val) {\n            return val.id === row.id;\n          });\n\n          _this4.list[index].status = params.status;\n          var statusText = params.status === '1' ? _this4.$t('systemmanagement_businessadress_index_1307') : _this4.$t('systemmanagement_businessadress_index_1308');\n          return message({\n            message: _this4.$t('systemmanagement_businessadress_index_1331', [row.urlName, statusText]),\n            type: 'success'\n          });\n        }\n      });\n    }\n  }\n};",null]}