{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\authoritymanagement\\defaultrole\\components\\AuthoritySearch.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\authoritymanagement\\defaultrole\\components\\AuthoritySearch.vue","mtime":1615171048100},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport _objectSpread from \"C:/Users/admin/Desktop/merchant-manager-web/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { message } from '@/utils/message';\nimport { generateTitle } from '@/utils/i18n';\nimport list from '@/mixins/list';\nimport { i18nRoute } from '@/utils/i18n';\nexport default {\n  name: 'AuthoritySearch',\n  mixins: [list],\n  props: {\n    // 0为线路商模板配置 1为普通商户模板配置 2为默认角色配置\n    type: {\n      type: Number,\n      default: 0\n    },\n    drawer: Boolean,\n    roledata: {\n      type: Object,\n      default: function _default() {\n        return {};\n      }\n    },\n    permissions: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    }\n  },\n  data: function data() {\n    return {\n      transferKey: 0,\n      elDrawer: false,\n      checkedAll: false,\n      checkedKeys: [],\n      ps: [],\n      form: {\n        roleName: '',\n        remark: ''\n      },\n      direction: 'ttb',\n      restaurants: [],\n      state2: '',\n      list: [],\n      permissionId: ''\n    };\n  },\n  computed: {\n    defaultProps: function defaultProps() {\n      return {\n        label: function label(data) {\n          return generateTitle(data.permissionName);\n        },\n        children: 'children'\n      };\n    }\n  },\n  watch: {\n    drawer: function drawer(val) {\n      this.elDrawer = val;\n      this.hasPermission(15308) && this.loadData2();\n    },\n    roledata: {\n      handler: function handler(newVal, old) {\n        if (newVal.id) {\n          this.form = _objectSpread({}, newVal);\n        } else {\n          this.resetForm();\n        }\n      },\n      deep: true\n    },\n    permissions: {\n      handler: function handler(newVal, oldVal) {\n        if (newVal) {\n          var arr = this.filterPS(newVal);\n          this.restaurants = arr.map(function (i) {\n            return {\n              value: i18nRoute(i.permissionName),\n              id: i.id\n            };\n          });\n        }\n      },\n      deep: true\n    }\n  },\n  methods: {\n    loadData2: function loadData2() {\n      var _this = this;\n\n      var form = {\n        pageSize: this.pageSize,\n        pageIndex: this.pageIndex,\n        permissionId: this.permissionId,\n        IsPage: true\n      };\n      this.$api.listPermissionAgent(form).then(function (res) {\n        _this.list = res.data.permissionAgentList;\n        _this.total = res.data.totalRecord;\n      });\n    },\n    // 点击复选框判断是否全选\n    clickIfAllChecked: function clickIfAllChecked(checkedKeys) {\n      var arr = this.filterPS(this.ps);\n\n      if (arr.length === checkedKeys.length) {\n        this.checkedAll = true;\n      } else {\n        this.checkedAll = false;\n      }\n    },\n    check: function check(data, obj) {\n      this.clickIfAllChecked(obj.checkedKeys);\n    },\n    filterPS: function filterPS(ps) {\n      var list = [];\n\n      var getList = function getList(ps) {\n        ps.forEach(function (item) {\n          if (item.children) {\n            list.push(item);\n            getList(item.children);\n          } else {\n            list.push(item);\n          }\n        });\n      };\n\n      getList(ps);\n      return list;\n    },\n    resetForm: function resetForm() {\n      this.form = {};\n      this.checkedAll = false;\n      this.resetTree();\n    },\n    handleClose: function handleClose() {\n      this.state2 = '';\n      this.permissionId = '';\n      this.resetDialog();\n      this.$emit('update:drawer', false);\n    },\n    resetDialog: function resetDialog() {\n      this.transferKey = +new Date();\n    },\n    querySearch: function querySearch(queryString, cb) {\n      var restaurants = this.restaurants;\n      var results = queryString ? restaurants.filter(function (restaurant) {\n        return restaurant.value.toLowerCase().indexOf(queryString.toLowerCase()) === 0;\n      }) : restaurants; // 调用 callback 返回建议列表的数据\n\n      cb(results);\n    },\n    loadAll: function loadAll() {\n      return [{\n        value: this.$t('authoritymanagement_defaultrole_components_authoritysearch_193'),\n        address: this.$t('authoritymanagement_defaultrole_components_authoritysearch_194')\n      }, {\n        value: this.$t('authoritymanagement_defaultrole_components_authoritysearch_195'),\n        address: this.$t('authoritymanagement_defaultrole_components_authoritysearch_196')\n      }];\n    },\n    handleSelect: function handleSelect(item) {\n      this.pageIndex = 1;\n      this.permissionId = item.id;\n      this.loadData2();\n    },\n    handleClearable: function handleClearable() {\n      this.permissionId = '';\n      this.loadData2();\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.loadData2();\n    },\n    deleteRow: function deleteRow(index, row) {\n      var _this2 = this;\n\n      this.$confirm(this.$t('authoritymanagement_defaultrole_components_authoritysearch_197'), this.$t('authoritymanagement_defaultrole_components_authoritysearch_198'), {\n        confirmButtonText: this.$t('authoritymanagement_defaultrole_components_authoritysearch_199'),\n        cancelButtonText: this.$t('authoritymanagement_defaultrole_components_authoritysearch_200'),\n        type: 'warning',\n        center: true\n      }).then(function () {\n        _this2.$api.deletePermissionAgent({\n          permissionId: row.permissionId,\n          agentCode: row.agentCode\n        }).then(function (res) {\n          if (res.code === 200) {\n            _this2.loadData2();\n\n            return message({\n              type: 'success',\n              message: _this2.$t('authoritymanagement_defaultrole_components_authoritysearch_201')\n            });\n          }\n        });\n      }).catch(function () {});\n    },\n    // 改变列表条数\n    handleSizeChange: function handleSizeChange(value) {\n      this.pageSize = value;\n      localStorage.setItem('pageSize', value);\n      this.loadData2();\n    },\n    getNameByTran: function getNameByTran(row) {\n      return i18nRoute(row.permissionName);\n    }\n  }\n};",null]}