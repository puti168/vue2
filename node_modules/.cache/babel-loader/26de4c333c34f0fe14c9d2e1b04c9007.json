{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\home\\components\\DataTrend.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\home\\components\\DataTrend.vue","mtime":1615171048119},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport _objectSpread from \"C:/Users/admin/Desktop/merchant-manager-web/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { formatCurrency } from '@/utils';\nimport dayjs from 'dayjs';\nimport SelectAgentTree from '@/components/SelectAgentTree';\nimport { mapGetters } from 'vuex';\nvar timer2;\nexport default {\n  name: 'DataTrend',\n  components: {\n    SelectAgentTree: SelectAgentTree\n  },\n  data: function data() {\n    var _this2 = this;\n\n    var start = dayjs().startOf('day').subtract(30, 'd').valueOf();\n    var end = dayjs().subtract(1, 'd').endOf('day').valueOf();\n    return {\n      // 走势时间区间\n      // 数据走势\n      trendData: {},\n      // 获取数据走势类型\n      trendTypes: 0,\n      form: {\n        agentId: '',\n        times: [start, end]\n      },\n      countDown: 30,\n      lineData: {\n        tooltip: {\n          trigger: 'axis',\n          formatter: function formatter(params) {\n            var str = '';\n            params && params.forEach(function (element, index) {\n              if (index === 0) {\n                str = \"<div>\".concat(_this2.$t('detailrecord.detailrecord_18'), \":\").concat(element.name, \"</div><div>\").concat(_this2.getEnName(element.seriesName), \":\").concat(formatCurrency(element.data, false), \"</div>\");\n              } else {\n                str += \"<div>\".concat(_this2.getEnName(element.seriesName), \":\").concat(formatCurrency(element.data, false), \"</div>\");\n              }\n            });\n            return str; // 最后返回拼接好的值\n          }\n        },\n        xAxis: {\n          type: 'category',\n          data: []\n        },\n        yAxis: {\n          type: 'value'\n        },\n        series: [{\n          name: this.$t('home_totalline_components_datatrend_431'),\n          data: [],\n          type: 'line',\n          // 显示数值\n          itemStyle: {\n            normal: {\n              label: {\n                formatter: function formatter(params) {\n                  if (params.data !== 0) {\n                    return formatCurrency(params.data, false);\n                  }\n\n                  return '';\n                }\n              }\n            }\n          },\n          smooth: false\n        }]\n      }\n    };\n  },\n  computed: _objectSpread(_objectSpread({}, mapGetters(['agentId'])), {}, {\n    pickerOptions: function pickerOptions() {\n      var _this = this;\n\n      return {\n        disabledDate: function disabledDate(time) {\n          var before = dayjs(_this.minDate).startOf('day').subtract(90, 'days').valueOf();\n          var after = dayjs(_this.minDate).endOf('day').add(90, 'days').valueOf();\n          var now = dayjs().subtract(1, 'd').endOf('day').valueOf(); // 如果after-now大于0,说明选择时间在当前时间90天之前\n\n          if (after - now < 0) {\n            return time.getTime() > after || time.getTime() < before;\n          } else if (_this.minDate) {\n            return time.getTime() > now || time.getTime() < before;\n          } else {\n            return time.getTime() > now;\n          }\n        },\n        onPick: function onPick(_ref) {\n          var maxDate = _ref.maxDate,\n              minDate = _ref.minDate;\n\n          if (!maxDate) {\n            _this.minDate = minDate;\n          }\n        }\n      };\n    }\n  }),\n  watch: {\n    'form.agentId': function formAgentId(val) {\n      this.getTrendData({\n        trendTypes: this.trendTypes,\n        times: this.form.times\n      });\n    },\n    trendData: function trendData(val) {\n      this.lineData.xAxis['data'] = val.xaxis.data;\n      this.lineData.series[0] = _objectSpread(_objectSpread(_objectSpread({}, this.lineData.series[0]), val.series[0]), {}, {\n        stack: this.$t('home_totalline_components_datatrend_432')\n      });\n\n      if (this.trendTypes === 3) {\n        this.lineData.series[1] = _objectSpread(_objectSpread({}, val.series[1]), {}, {\n          itemStyle: {\n            normal: {\n              label: {\n                position: 'bottom',\n                formatter: function formatter(params) {\n                  if (params.data !== 0) {\n                    return formatCurrency(params.data, false);\n                  }\n\n                  return '';\n                }\n              },\n              lineStyle: {\n                width: 2,\n                type: 'dashed' // 'dotted'虚线 'solid'实线\n\n              }\n            }\n          },\n          stack: this.$t('home_totalline_components_datatrend_433')\n        });\n        this.lineData.series[2] = _objectSpread(_objectSpread({}, val.series[2]), {}, {\n          itemStyle: {\n            normal: {\n              label: {\n                position: 'bottom',\n                formatter: function formatter(params) {\n                  if (params.data !== 0) {\n                    return formatCurrency(params.data, false);\n                  }\n\n                  return '';\n                }\n              },\n              lineStyle: {\n                width: 2,\n                type: 'dotted' // 'dotted'虚线 'solid'实线\n\n              }\n            }\n          },\n          stack: this.$t('home_totalline_components_datatrend_434')\n        });\n      } else {\n        this.lineData.series.splice(1, 2);\n      }\n\n      this.lineData = _objectSpread({}, this.lineData);\n    }\n  },\n  created: function created() {\n    this.form.agentId = this.agentId;\n  },\n  mounted: function mounted() {\n    window.addEventListener('resize', this.resizeHandle);\n  },\n  destroyed: function destroyed() {\n    window.removeEventListener('resize', this.resizeHandle);\n    clearInterval(timer2);\n  },\n  methods: {\n    getEnName: function getEnName(name) {\n      if (name.includes('新增注册人数')) {\n        return this.$t('home_totalline_components_datatrend_413');\n      }\n\n      if (name.includes('上线会员趋势')) {\n        return this.$t('home_totalline_components_datatrend_415');\n      }\n\n      if (name.includes('投注真钱用户数')) {\n        return this.$t('home_totalline_components_datatrend_417');\n      }\n\n      if (name.includes('派彩')) {\n        return this.$t('home_totalline_components_datatrend_428');\n      }\n\n      if (name === '投注金额') {\n        return this.$t('home_totalline_components_datatrend_426');\n      }\n\n      if (name === '有效投注金额') {\n        return this.$t('home_totalline_components_datatrend_427');\n      }\n\n      if (name.includes('商户盈利趋势')) {\n        return this.$t('home_totalline_components_datatrend_421');\n      }\n\n      return name;\n    },\n    // 数据走势数据获取\n    getTrendData: function getTrendData(data) {\n      var _this3 = this;\n\n      var api;\n\n      switch (data.trendTypes) {\n        case 0:\n          api = 'newRegisterAnalysis';\n          break;\n\n        case 1:\n          api = 'onlinePlayersAnalysis';\n          break;\n\n        case 2:\n          api = 'betPlayersAnalysis';\n          break;\n\n        case 3:\n          api = 'betAndPayoutAnalysis';\n          break;\n\n        case 4:\n          api = 'betNetAmountAnalysis';\n          break;\n      }\n\n      this.$api[api]({\n        agentId: this.form.agentId,\n        startDate: data.times ? data.times[0] : '',\n        endDate: data.times ? data.times[1] : ''\n      }).then(function (res) {\n        if (res.code === 200) {\n          _this3.trendData = res.data;\n          _this3.showDataTrend = true;\n        }\n      });\n    },\n    // 数据走势条件改变\n    trendDataChange: function trendDataChange(data) {\n      var _this4 = this;\n\n      console.log('33');\n\n      if (data.trendTypes !== undefined) {\n        this.trendTypes = data.trendTypes;\n      }\n\n      if (data.times) {\n        this.form.times = data.times;\n      }\n\n      this.$nextTick(function () {\n        _this4.getTrendData({\n          trendTypes: _this4.trendTypes,\n          times: _this4.form.times\n        });\n      });\n    },\n    resizeHandle: function resizeHandle() {\n      this.$refs.myEchart && this.$refs.myEchart.resize();\n    },\n    handleChartType: function handleChartType(index) {\n      this.trendDataChange({\n        trendTypes: index\n      });\n    },\n    timeChange: function timeChange(value) {\n      this.trendDataChange({\n        times: value\n      });\n    },\n    getText: function getText() {\n      var trendTypes = this.trendTypes;\n      var scopeText, unitText;\n\n      if (trendTypes === 0) {\n        scopeText = this.$t('home_totalline_components_datatrend_435');\n        unitText = this.$t('home_totalline_components_datatrend_436');\n      } else if (trendTypes === 1) {\n        scopeText = this.$t('home_totalline_components_datatrend_437');\n        unitText = this.$t('home_totalline_components_datatrend_436');\n      } else if (trendTypes === 2) {\n        scopeText = this.$t('home_totalline_components_datatrend_438');\n        unitText = this.$t('home_totalline_components_datatrend_439');\n      } else {\n        scopeText = this.$t('home_totalline_components_datatrend_440');\n        unitText = this.$t('home_totalline_components_datatrend_441');\n      }\n\n      return {\n        scopeText: scopeText,\n        unitText: unitText\n      };\n    },\n    // 刷新倒计时\n    refreshCountDown: function refreshCountDown() {\n      var _this5 = this;\n\n      var time = setInterval(function () {\n        _this5.countDown = _this5.countDown - 1;\n\n        if (_this5.countDown === 0) {\n          clearInterval(time);\n          _this5.countDown = 30;\n        }\n      }, 1000);\n    },\n    // 刷新\n    onRefresh: function onRefresh(value) {\n      this.trendDataChange();\n      this.refreshCountDown();\n    }\n  }\n};",null]}