{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\merchant\\dotaccount\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\merchant\\dotaccount\\index.vue","mtime":1617695097422},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"C:/Users/admin/Desktop/merchant-manager-web/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport list from '@/mixins/list';\nimport { mapGetters } from 'vuex';\nimport { routerNames } from '@/utils/consts';\nimport SelectAgentTree from '@/components/SelectAgentTree';\nimport router from '@/router';\nimport dayjs from 'dayjs';\nexport default {\n  name: routerNames.dotaccount,\n  components: {\n    SelectAgentTree: SelectAgentTree\n  },\n  mixins: [list],\n  data: function data() {\n    var start = dayjs().startOf('day').valueOf();\n    var end = dayjs().endOf('day').valueOf();\n    return {\n      hadSearch: false,\n      loading: false,\n      form: {\n        time: [start, end],\n        tranType: -1,\n        agentId: ''\n      },\n      amountData: {},\n      rechargeVisible: false,\n      rechargeData: {},\n      prevIndex: 1,\n      summary: ''\n    };\n  },\n  computed: _objectSpread(_objectSpread({}, mapGetters(['globalDics'])), mapGetters(['userInfo'])),\n  activated: function activated() {\n    var _this = this;\n\n    window.clearInterval(window.aaatimer);\n    window.aaatimer = null;\n\n    if (!window.bbbtimer) {\n      window.bbbtimer = window.setInterval(function () {\n        _this.summary && _this.addTotalAmount();\n      }, 800);\n    }\n  },\n  destroyed: function destroyed() {\n    window.clearInterval(window.bbbtimer);\n    window.bbbtimer = null;\n  },\n  beforeRouteLeave: function beforeRouteLeave(to, from, next) {\n    window.clearInterval(window.bbbtimer);\n    window.bbbtimer = null;\n    next();\n  },\n  methods: {\n    // 失去焦点的时候重置\n    onTimeBlur: function onTimeBlur() {\n      this.minDate = null;\n    },\n    getOppositeName: function getOppositeName(row) {\n      var tranType = row.tranType;\n\n      if (tranType === 3 || tranType === 4) {\n        return row.oppositeNo ? row.oppositeNo : '-';\n      } else {\n        return row.oppositeName ? row.oppositeName : '-';\n      }\n    },\n    loadData: function loadData() {\n      var _this2 = this;\n\n      // 2020-4-28修改为开始和结束时间不能跨月\n      if (this.form.time) {\n        var month0 = dayjs(this.form.time[0]).month();\n        var month1 = dayjs(this.form.time[1]).month();\n\n        if (month0 !== month1) {\n          return this.$message({\n            message: this.$t('merchant_dotaccount_index_875'),\n            type: 'warning'\n          });\n        }\n      }\n\n      this.loading = true;\n\n      if (this.$route.query && JSON.stringify(this.$route.query) !== '{}') {\n        var query = this.$route.query || {};\n        this.form.agentId = query.agentId;\n        router.push(this.$route.path);\n      }\n\n      var pageData = {\n        pageSize: this.pageSize,\n        pageIndex: this.pageIndex,\n        startBetTime: this.form.time[0],\n        endBetTime: this.form.time[1],\n        searchAgentId: this.form.agentId\n      };\n      var requestData = this.hadSearch ? {\n        tranType: this.form.tranType\n      } : {};\n\n      var form = _objectSpread(_objectSpread({}, pageData), requestData);\n\n      this.$api.queryAgentAccountRecord(form).then(function (_) {\n        _this2.loading = false;\n\n        if (_.code === 200) {\n          var data = _.data;\n          _this2.list = data.record;\n          _this2.total = data.totalRecord;\n          _this2.summary = data.summary;\n\n          _this2.$nextTick(function () {\n            _this2.addTotalAmount();\n          });\n        }\n      }).catch(function () {\n        _this2.pageIndex = _this2.prevIndex;\n        _this2.list = [];\n        _this2.total = 0;\n        _this2.loading = false;\n      });\n    },\n    addTotalAmount: function addTotalAmount() {\n      var totalSpan = document.querySelector('.total-span');\n      var pageNode = document.querySelector('.el-pagination');\n      var prevNode = document.querySelector('.el-pagination__total');\n      var newNode = document.createElement('span');\n\n      if (!totalSpan) {\n        newNode.innerText = this.$t('members_accounttransaction_index_506', [this.summary]);\n        newNode.style.margin = '0 15px';\n        newNode.style.fontWeight = '400';\n        newNode.className = 'total-span';\n        pageNode && pageNode.insertBefore(newNode, prevNode);\n      } else {\n        var str = this.$t('members_accounttransaction_index_506', [this.summary]);\n        totalSpan.innerText = str;\n      }\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.prevIndex = this.pageIndex;\n      this.pageIndex = val;\n      this.loadData();\n    },\n    handleReset: function handleReset() {\n      var _this3 = this;\n\n      if (this.$route.query && JSON.stringify(this.$route.query) !== '{}') {\n        router.push(this.$route.path, function () {\n          _this3.resetCommon();\n        });\n      } else {\n        this.resetCommon();\n      }\n    },\n    resetCommon: function resetCommon() {\n      var start = dayjs().startOf('day').valueOf();\n      var end = dayjs().endOf('day').valueOf();\n      this.hadSearch = false;\n      this.form = {\n        time: [start, end],\n        agentName: '',\n        tranType: -1,\n        agentId: ''\n      };\n      this.initList();\n    },\n    handleSearch: function handleSearch() {\n      this.hadSearch = true;\n      this.pageIndex = 1;\n      this.loadData();\n    },\n    getTranType: function getTranType(type) {\n      switch (type) {\n        case 1:\n          return this.$t('merchant_dotaccount_index_856');\n\n        case 2:\n          return this.$t('merchant_dotaccount_index_857');\n\n        case 3:\n          return this.$t('merchant_dotaccount_index_854');\n\n        case 4:\n          return this.$t('merchant_dotaccount_index_855');\n\n        default:\n          return '-';\n      }\n    },\n    getSummaries: function getSummaries(param) {// const { columns, data } = param\n      // const sums = []\n      // columns.forEach((column, index) => {\n      // \tif (index === 5) {\n      // \t\tsums[index] = '总计'\n      // \t\treturn\n      // \t}\n      // \tconst values = data.map((item) => Number(item[column.property]))\n      // \tif (\n      // \t\t!values.every((value) => isNaN(value)) &&\n      // \t\t(column.property === 'preBalance' ||\n      // \t\t\tcolumn.property === 'amount' ||\n      // \t\t\tcolumn.property === 'afterBalance')\n      // \t) {\n      // \t\tsums[index] = this.summary[column.property]\n      // \t}\n      // })\n      // return sums\n    }\n  }\n};",null]}