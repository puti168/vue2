{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\merchant\\merchantInfo\\components\\Setting.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\merchant\\merchantInfo\\components\\Setting.vue","mtime":1616384580093},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport _objectSpread from \"C:/Users/admin/Desktop/merchant-manager-web/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport dayjs from 'dayjs';\nimport { decimalValidate } from '@/utils/validate';\nexport default {\n  name: 'EditTrial',\n  props: {\n    accountData: {\n      type: Object,\n      default: function _default() {}\n    },\n    value: {\n      type: Boolean,\n      default: false\n    },\n    settingSuccess: {\n      type: Function,\n      default: function _default() {}\n    }\n  },\n  data: function data() {\n    return {\n      apiRateStatus: true,\n      countPercentageStatus: true,\n      apiRateData: [],\n      dotData: [],\n      showApiRate: false,\n      showDot: false,\n      insideLoading: false,\n      apiRate: '',\n      countPercentage: '',\n      accountForm: {\n        model: 2,\n        agentName: '',\n        apiRate: '',\n        cooperations: []\n      }\n    };\n  },\n  computed: {\n    pickerOptionsM: function pickerOptionsM() {\n      var _this = this;\n\n      return {\n        disabledDate: function disabledDate(time) {\n          var now = dayjs().endOf('day').valueOf();\n          return time.getTime() < now;\n        },\n        onPick: function onPick(_ref) {\n          var maxDate = _ref.maxDate,\n              minDate = _ref.minDate;\n\n          if (!maxDate) {\n            _this.minDate = minDate;\n          }\n        }\n      };\n    },\n    accountFormRules: function accountFormRules() {\n      var _this2 = this;\n\n      var countPercentageValidate = function countPercentageValidate(rule, value, callback) {\n        if (!decimalValidate(value) || Number(value) === 0 || Number(value) > 100) {\n          callback(new Error(_this2.$t('merchant_merchantinfo_components_editaccount_961')));\n        } else {\n          callback();\n        }\n      };\n\n      var apiRateValidate = function apiRateValidate(rule, value, callback) {\n        if (!decimalValidate(value) || Number(value) === 0 || Number(value) > 100) {\n          callback(new Error(_this2.$t('merchant_merchantinfo_components_editaccount_962')));\n        } else {\n          callback();\n        }\n      };\n\n      return {\n        apiRate: [{\n          required: true,\n          validator: apiRateValidate,\n          trigger: 'blur'\n        }],\n        countPercentage: [{\n          required: true,\n          validator: countPercentageValidate,\n          trigger: 'blur'\n        }]\n      };\n    }\n  },\n  watch: {\n    accountData: function accountData(val) {\n      this.accountForm = _objectSpread(_objectSpread({}, val), {}, {\n        cooperations: val.cooperationModel === 1 ? [2, 3] : [val.cooperationModel],\n        rateSharingEffectiveDate: val.rateSharingEffectiveDate ? dayjs(val.rateSharingEffectiveDate).valueOf() : new Date().valueOf() + 3600000,\n        buyCreditsEffectiveDate: val.buyCreditsEffectiveDate ? dayjs(val.buyCreditsEffectiveDate).valueOf() : new Date().valueOf() + 3600000\n      });\n      this.apiRate = val.apiRate;\n      this.countPercentage = val.countPercentage;\n    },\n    'accountForm.countPercentage': {\n      handler: function handler(val) {\n        if (this.accountData.activeStatus !== 0) {\n          this.countPercentageStatus = false;\n        } else {\n          this.countPercentageStatus = true;\n        }\n      },\n      deep: true\n    },\n    'accountForm.apiRate': {\n      handler: function handler(val) {\n        if (this.accountData.activeStatus !== 0) {\n          this.apiRateStatus = false;\n        } else {\n          this.apiRateStatus = true;\n        }\n      },\n      deep: true\n    }\n  },\n  mounted: function mounted() {},\n  methods: {\n    handleClose: function handleClose() {\n      this.$refs.accountForm.clearValidate();\n      this.showApiRate = false;\n      this.showDot = false;\n      this.$emit('input', false);\n    },\n    // 根据合作模式的不同，展示不同结算账户\n    getSettlementAccount: function getSettlementAccount() {\n      if (this.accountForm.cooperations.includes(2) && this.accountForm.cooperations.includes(3)) {\n        return this.$t('merchant_merchantinfo_components_editaccount_965');\n      } else if (this.accountForm.cooperations.includes(2)) {\n        return this.$t('merchant_merchantinfo_components_editaccount_966');\n      } else if (this.accountForm.cooperations.includes(3)) {\n        return this.$t('merchant_merchantinfo_components_editaccount_967');\n      }\n    },\n    commitAccount: function commitAccount() {\n      var _this3 = this;\n\n      this.$refs.accountForm.validate(function (valid) {\n        if (valid) {\n          var loading = _this3.$loading({\n            lock: true,\n            text: 'Loading',\n            spinner: 'el-icon-loading',\n            background: 'rgba(0, 0, 0, 0.7)'\n          });\n\n          var form = {\n            agentId: _this3.accountForm.agentId,\n            apiRate: _this3.accountForm.apiRate && Number(_this3.accountForm.apiRate),\n            countPercentage: _this3.accountForm.countPercentage && Number(_this3.accountForm.countPercentage),\n            buyCreditsEffectiveDate: _this3.countPercentage ? String(_this3.accountForm.buyCreditsEffectiveDate) : '',\n            rateSharingEffectiveDate: _this3.apiRate ? String(_this3.accountForm.rateSharingEffectiveDate) : ''\n          };\n\n          _this3.$api.agentAccountSet(form).then(function (_) {\n            if (_.code === 200) {\n              _this3.$emit('input', false);\n\n              if (_this3.accountForm.activeStatus === 0) {\n                _this3.$emit('settingSuccess', _this3.accountForm);\n              } else {\n                if (!_this3.apiRate && _this3.accountForm.apiRate || !_this3.countPercentage && _this3.accountForm.countPercentage) {\n                  _this3.$emit('settingSuccess', _this3.accountForm);\n                } else {\n                  _this3.$emit('settingSuccess');\n                }\n              }\n\n              _this3.$message({\n                message: _this3.$t(_this3.$t('merchant_merchantinfo_components_edittrial_987')),\n                type: 'success'\n              });\n            }\n\n            loading.close();\n          }).catch(function () {\n            loading.close();\n          });\n        }\n      });\n    },\n    changeTable: function changeTable(value) {\n      var _this4 = this;\n\n      this[value] = !this[value];\n      this.insideLoading = true;\n\n      if (this[value] && value === 'showApiRate') {\n        this.$api.getRateApiHistory({\n          agentId: this.accountForm.agentId\n        }).then(function (res) {\n          if (res.code === 200) {\n            _this4.apiRateData = res.data || [];\n          }\n\n          _this4.insideLoading = false;\n        }).catch(function () {\n          _this4.insideLoading = false;\n        });\n      } else if (this[value]) {\n        this.$api.getCountPercentageHistory({\n          agentId: this.accountForm.agentId\n        }).then(function (res) {\n          if (res.code === 200) {\n            _this4.dotData = res.data || [];\n          }\n\n          _this4.insideLoading = false;\n        }).catch(function () {\n          _this4.insideLoading = false;\n        });\n      }\n    }\n  }\n};",null]}