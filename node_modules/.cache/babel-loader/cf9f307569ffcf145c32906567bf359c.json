{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\pages\\index\\store\\modules\\permission.js","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\pages\\index\\store\\modules\\permission.js","mtime":1617594855322},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJDOi9Vc2Vycy9hZG1pbi9EZXNrdG9wL21lcmNoYW50LW1hbmFnZXItd2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCB7IGNvbnN0YW50Um91dGVyQ29tcG9uZW50cywgY29uc3RhbnRSb3V0ZXJNYXAsIGxhc3RDb25zdGFudFJvdXRlcnMgfSBmcm9tICdpbmRleC9yb3V0ZXIvdGFibGUnOwovKioNCiAqIOWkhOeQhuWQjuWPsOi/lOWbnuiPnOWNleaVsOaNrg0KICogQHBhcmFtIHsqfSByb290TWVudSANCiAqIEBwYXJhbSB7Kn0gZm9sbG93TWVyY3RzIA0KICovCgpmdW5jdGlvbiBmaWx0ZXJBc3luY1JvdXRlcihyb290TWVudSkgewogIHZhciBhY2Nlc3NlZFJvdXRlcnMgPSBnZW5lcmF0ZU1lbnUocm9vdE1lbnUpOwogIHZhciByb3V0ZXJzID0gW2FjY2Vzc2VkUm91dGVyc10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShsYXN0Q29uc3RhbnRSb3V0ZXJzKSk7CiAgcmV0dXJuIHJvdXRlcnM7Cn0KLyoqDQogKiDnlJ/miJDoj5zljZUNCiAqIEBwYXJhbSB7Kn0gbWVudSANCiAqIEBwYXJhbSB7Kn0gcGFyZW50IA0KICovCgoKZnVuY3Rpb24gZ2VuZXJhdGVNZW51KG1lbnUsIHBhcmVudCkgewogIHZhciBjb2RlID0gbWVudS5jb2RlLAogICAgICBwYXRoID0gbWVudS5wYXRoLAogICAgICBuYW1lID0gbWVudS5uYW1lLAogICAgICB0eXBlID0gbWVudS50eXBlLAogICAgICBpY29uID0gbWVudS5pY29uLAogICAgICBfbWVudSRjaGlsZHJlbiA9IG1lbnUuY2hpbGRyZW4sCiAgICAgIGNoaWxkcmVuID0gX21lbnUkY2hpbGRyZW4gPT09IHZvaWQgMCA/IFtdIDogX21lbnUkY2hpbGRyZW47IC8v5aaC5p6c5piv5pON5L2c5p2D6ZmQCgogIGlmIChwYXJlbnQgJiYgY29kZSAmJiB0eXBlID09IDIpIHsKICAgIHBhcmVudC5tZXRhLmFjdGlvbnMucHVzaChjb2RlKTsKICAgIHJldHVybjsKICB9IC8v6I+c5Y2V5p2D6ZmQ5aSE55CG6YC76L6RCgoKICBpZiAoIXBhdGgpIHsKICAgIHJldHVybjsKICB9CgogIHZhciBjdXJyZW50ID0gewogICAgcGF0aDogcGF0aCwKICAgIG5hbWU6IHBhdGgsCiAgICBjb21wb25lbnQ6IGNvbnN0YW50Um91dGVyQ29tcG9uZW50c1twYXRoXSwKICAgIG1ldGE6IHsKICAgICAgdGl0bGU6IG5hbWUsCiAgICAgIGljb246IGljb24sCiAgICAgIGFjdGlvbnM6IFtdLAogICAgICBrZWVwQWxpdmU6IGZhbHNlCiAgICB9CiAgfTsKCiAgaWYgKHBhcmVudCAmJiB0eXBlID09IDEpIHsKICAgIHBhcmVudC5tZXRhLmtlZXBBbGl2ZSA9IHRydWU7CgogICAgaWYgKCFwYXJlbnQuY2hpbGRyZW4pIHsKICAgICAgcGFyZW50LmNoaWxkcmVuID0gW107CiAgICB9CgogICAgcGFyZW50LmNoaWxkcmVuLnB1c2goY3VycmVudCk7CgogICAgaWYgKCFwYXJlbnQucmVkaXJlY3QpIHsKICAgICAgcGFyZW50LnJlZGlyZWN0ID0gbWVudS5wYXRoOwogICAgfQogIH0KCiAgY2hpbGRyZW4gJiYgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAodikgewogICAgZ2VuZXJhdGVNZW51KHYsIGN1cnJlbnQpOwogIH0pOwogIHJldHVybiBjdXJyZW50Owp9Cgp2YXIgcGVybWlzc2lvbiA9IHsKICBzdGF0ZTogewogICAgcm91dGVyczogY29uc3RhbnRSb3V0ZXJNYXAsCiAgICBhZGRSb3V0ZXJzOiBbXQogIH0sCiAgbXV0YXRpb25zOiB7CiAgICBTRVRfUk9VVEVSUzogZnVuY3Rpb24gU0VUX1JPVVRFUlMoc3RhdGUsIHJvdXRlcnMpIHsKICAgICAgc3RhdGUuYWRkUm91dGVycyA9IHJvdXRlcnM7CiAgICAgIHN0YXRlLnJvdXRlcnMgPSBjb25zdGFudFJvdXRlck1hcC5jb25jYXQocm91dGVycyk7CiAgICB9CiAgfSwKICBhY3Rpb25zOiB7CiAgICBHZW5lcmF0ZVJvdXRlczogZnVuY3Rpb24gR2VuZXJhdGVSb3V0ZXMoX3JlZiwgZGF0YSkgewogICAgICB2YXIgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgIHZhciBtZW51VHJlZSA9IGRhdGEubWVudVRyZWU7CiAgICAgICAgdmFyIGFzeW5jUm91dGVyTWFwID0gZmlsdGVyQXN5bmNSb3V0ZXIobWVudVRyZWUpOwogICAgICAgIGNvbW1pdCgnU0VUX1JPVVRFUlMnLCBhc3luY1JvdXRlck1hcCk7CiAgICAgICAgcmVzb2x2ZSgpOwogICAgICB9KTsKICAgIH0KICB9Cn07CmV4cG9ydCBkZWZhdWx0IHBlcm1pc3Npb247"},{"version":3,"sources":["C:/Users/admin/Desktop/merchant-manager-web/src/pages/index/store/modules/permission.js"],"names":["constantRouterComponents","constantRouterMap","lastConstantRouters","filterAsyncRouter","rootMenu","accessedRouters","generateMenu","routers","menu","parent","code","path","name","type","icon","children","meta","actions","push","current","component","title","keepAlive","redirect","forEach","v","permission","state","addRouters","mutations","SET_ROUTERS","concat","GenerateRoutes","data","commit","Promise","resolve","menuTree","asyncRouterMap"],"mappings":"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","sourcesContent":["import { constantRouterComponents, constantRouterMap, lastConstantRouters } from 'index/router/table'\r\n\r\n/**\r\n * 处理后台返回菜单数据\r\n * @param {*} rootMenu \r\n * @param {*} followMercts \r\n */\r\nfunction filterAsyncRouter(rootMenu) {\r\n  const accessedRouters = generateMenu(rootMenu)\r\n  const routers = [\r\n    accessedRouters,\r\n    ...lastConstantRouters\r\n  ]\r\n  return routers\r\n}\r\n\r\n/**\r\n * 生成菜单\r\n * @param {*} menu \r\n * @param {*} parent \r\n */\r\nfunction generateMenu(menu, parent) {\r\n  const { code, path, name, type, icon, children = [] } = menu\r\n  //如果是操作权限\r\n  if (parent && code && type == 2) {\r\n    parent.meta.actions.push(code)\r\n    return\r\n  }\r\n  //菜单权限处理逻辑\r\n  if (!path) {\r\n    return\r\n  }\r\n  const current = {\r\n    path: path,\r\n    name: path,\r\n    component: constantRouterComponents[path],\r\n    meta: { title: name, icon, actions: [], keepAlive: false },\r\n  }\r\n  if (parent && type == 1) {\r\n    parent.meta.keepAlive = true\r\n    if (!parent.children) {\r\n      parent.children = []\r\n    }\r\n    parent.children.push(current)\r\n    if (!parent.redirect) {\r\n      parent.redirect = menu.path\r\n    }\r\n  }\r\n  children && children.forEach(v => {\r\n    generateMenu(v, current)\r\n  })\r\n  return current\r\n}\r\n\r\nconst permission = {\r\n  state: {\r\n    routers: constantRouterMap,\r\n    addRouters: []\r\n  },\r\n  mutations: {\r\n    SET_ROUTERS: (state, routers) => {\r\n      state.addRouters = routers\r\n      state.routers = constantRouterMap.concat(routers)\r\n    }\r\n  },\r\n  actions: {\r\n    GenerateRoutes({ commit }, data) {\r\n      return new Promise(resolve => {\r\n        const { menuTree } = data\r\n        const asyncRouterMap = filterAsyncRouter(menuTree)\r\n        commit('SET_ROUTERS', asyncRouterMap)\r\n        resolve()\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\nexport default permission\r\n"]}]}