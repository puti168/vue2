{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\authoritymanagement\\usermanage\\components\\UserDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\authoritymanagement\\usermanage\\components\\UserDetail.vue","mtime":1615171048111},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { mapGetters } from 'vuex'\r\nimport { generateTitle } from '@/utils/i18n'\r\n\r\nexport default {\r\n\tname: 'Editrole',\r\n\tprops: {\r\n\t\tassignedPermissions: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: function () {\r\n\t\t\t\treturn {}\r\n\t\t\t}\r\n\t\t},\r\n\t\tdetailPermissions: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: function () {\r\n\t\t\t\treturn {}\r\n\t\t\t}\r\n\t\t},\r\n\t\troledata: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: function () {\r\n\t\t\t\treturn {}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\ttransferKey: 0,\r\n\t\t\tcheckedKeys: [],\r\n\t\t\tps: [],\r\n\t\t\tform: {\r\n\t\t\t\troleName: '',\r\n\t\t\t\tremark: ''\r\n\t\t\t},\r\n\t\t\tdirection: 'ttb',\r\n\t\t\tmemoryRemark: '', // 用于判断是否做修改,\r\n\t\t\tmemoryIds: []\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapGetters(['userInfo']),\r\n\t\tdefaultProps() {\r\n\t\t\treturn {\r\n\t\t\t\tlabel: (data) => {\r\n\t\t\t\t\treturn generateTitle(data.permissionName)\r\n\t\t\t\t},\r\n\t\t\t\tchildren: 'children'\r\n\t\t\t}\r\n\t\t},\r\n\t\trules() {\r\n\t\t\tconst validRoleName = (rule, value, callback) => {\r\n\t\t\t\tif (!value) {\r\n\t\t\t\t\tcallback(\r\n\t\t\t\t\t\tnew Error(\r\n\t\t\t\t\t\t\tthis.$t('authoritymanagement_usermanage_components_userdetail_12')\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t)\r\n\t\t\t\t} else if (value && value.length > 20) {\r\n\t\t\t\t\tcallback(\r\n\t\t\t\t\t\tnew Error(\r\n\t\t\t\t\t\t\tthis.$t('authoritymanagement_usermanage_components_userdetail_13')\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t)\r\n\t\t\t\t} else if (!/^[\\u4e00-\\u9fa5]{1,20}$/.test(value)) {\r\n\t\t\t\t\tcallback(\r\n\t\t\t\t\t\tnew Error(\r\n\t\t\t\t\t\t\tthis.$t('authoritymanagement_usermanage_components_userdetail_14')\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\troleName: [{ required: true, validator: validRoleName, trigger: 'blur' }]\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\troledata: {\r\n\t\t\thandler(newVal, old) {\r\n\t\t\t\tif (newVal.id) {\r\n\t\t\t\t\tthis.form.roleName = newVal.roleName\r\n\t\t\t\t\tthis.form.remark = newVal.remark\r\n\t\t\t\t\tthis.memoryRemark = newVal.remark\r\n\t\t\t\t\tthis.form.id = newVal.id\r\n\t\t\t\t\tthis.form.systemType = newVal.systemType\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.resetForm()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\timmediate: true,\r\n\t\t\tdeep: true\r\n\t\t},\r\n\t\tdetailPermissions: {\r\n\t\t\thandler(newVal, oldVal) {\r\n\t\t\t\tif (newVal) {\r\n\t\t\t\t\tthis.ps = newVal\r\n\t\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t\t// 叶子节点平铺\r\n\t\t\t\t\t\tconst doms =\r\n\t\t\t\t\t\t\tdocument.querySelectorAll('.el-tree-node__content > .is-leaf') || []\r\n\t\t\t\t\t\tdoms.length !== 0 &&\r\n\t\t\t\t\t\t\tdoms.forEach((node) => {\r\n\t\t\t\t\t\t\t\tnode.parentNode.classList.add('tile')\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdeep: true\r\n\t\t},\r\n\t\tassignedPermissions: {\r\n\t\t\thandler(newVal, oldVal) {\r\n\t\t\t\tif (newVal.length && newVal.length > 0) {\r\n\t\t\t\t\tnewVal.forEach((element) => {\r\n\t\t\t\t\t\tif (element.includes('list')) {\r\n\t\t\t\t\t\t\tthis.memoryIds.push(element.replace('list', ''))\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.memoryIds.push(element)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.$refs.tree.setCheckedKeys([])\r\n\t\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t\tthis.checkIfAllChecked()\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdeep: true\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tcheckIfAllChecked() {\r\n\t\t\tlet arr = this.filterPS(this.ps)\r\n\t\t\tarr = arr.filter((val) => !val.id.includes('list'))\r\n\t\t\tif (arr.length <= this.assignedPermissions.length) {\r\n\t\t\t\tthis.checkedAll = true\r\n\t\t\t} else {\r\n\t\t\t\tthis.checkedAll = false\r\n\t\t\t}\r\n\t\t},\r\n\t\tfilterPS(ps) {\r\n\t\t\tconst list = []\r\n\t\t\tconst getList = function (ps) {\r\n\t\t\t\tps.forEach((item) => {\r\n\t\t\t\t\t// item.disabled = true\r\n\t\t\t\t\tif (item.children) {\r\n\t\t\t\t\t\tlist.push(item)\r\n\t\t\t\t\t\tgetList(item.children)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlist.push(item)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tgetList(ps)\r\n\t\t\treturn list\r\n\t\t},\r\n\t\tresetForm() {\r\n\t\t\tthis.form = {}\r\n\t\t\tthis.checkedAll = false\r\n\t\t\tthis.resetTree()\r\n\t\t},\r\n\t\thandleClose() {\r\n\t\t\tthis.$emit('closeDetail')\r\n\t\t},\r\n\t\thandleClosed() {\r\n\t\t\tthis.resetDialog()\r\n\t\t},\r\n\t\tresetDialog() {\r\n\t\t\tthis.$refs.form.resetFields()\r\n\t\t\tthis.transferKey = +new Date()\r\n\t\t\tthis.memoryRemark = ''\r\n\t\t\tthis.memoryIds = []\r\n\t\t}\r\n\t}\r\n}\r\n",null]}