{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\merchant\\accountInfo\\components\\Recharge.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\merchant\\accountInfo\\components\\Recharge.vue","mtime":1616384580074},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { formatCurrency } from '@/utils'\r\nimport { message } from '@/utils/message'\r\nimport { mapGetters } from 'vuex'\r\n\r\nexport default {\r\n\tname: 'Recharge',\r\n\tprops: {\r\n\t\tvisible: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t},\r\n\t\trechargeData: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: () => {}\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tdrawer: false,\r\n\t\t\tform: {\r\n\t\t\t\tamount: 0\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapGetters(['userInfo']),\r\n\t\trules() {\r\n\t\t\t// 平台账户不做限制\r\n\t\t\tconst userBalance = this.userInfo.balance || 0\r\n\t\t\tconst validNumber = (rule, value, callback) => {\r\n\t\t\t\tconst newValue = Number(value)\r\n\t\t\t\tif (/^\\-[0-9][0-9]*/.test(value)) {\r\n\t\t\t\t\tcallback(\r\n\t\t\t\t\t\tnew Error(this.$t('merchant_accountinfo_components_recharge_735'))\r\n\t\t\t\t\t)\r\n\t\t\t\t} else if (typeof newValue !== 'number' || value % 1 !== 0) {\r\n\t\t\t\t\tcallback(\r\n\t\t\t\t\t\tnew Error(this.$t('merchant_accountinfo_components_recharge_736'))\r\n\t\t\t\t\t)\r\n\t\t\t\t} else if (this.userInfo.id !== 1 && value > Number(userBalance)) {\r\n\t\t\t\t\tcallback(\r\n\t\t\t\t\t\tnew Error(this.$t('merchant_accountinfo_components_recharge_737'))\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\tamount: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\tmessage: this.$t('merchant_accountinfo_components_recharge_732'),\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{ validator: validNumber, trigger: 'blur' }\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\tvisible(val) {\r\n\t\t\tthis.drawer = val\r\n\t\t}\r\n\t},\r\n\tcreated() {\r\n\t},\r\n\tmethods: {\r\n\t\tformatCurrency,\r\n\t\tqueryUserInfo() {\r\n\t\t\tthis.$store.dispatch('user/queryUserInfo', this.userInfo)\r\n\t\t},\r\n\t\tcancel() {\r\n\t\t\tthis.form.amount = 0\r\n\t\t\tthis.$refs.form.clearValidate()\r\n\t\t\tthis.$emit('update:visible', false)\r\n\t\t},\r\n\t\thanldeSure() {\r\n\t\t\tthis.$refs.form.validate((valid) => {\r\n\t\t\t\tconst form = {\r\n\t\t\t\t\tagentId: this.rechargeData.agentId,\r\n\t\t\t\t\tagentName: this.rechargeData.agentName,\r\n\t\t\t\t\tamount: this.form.amount,\r\n\t\t\t\t\ttype: 1\r\n\t\t\t\t}\r\n\t\t\t\tif (valid) {\r\n\t\t\t\t\tthis.$api.merchantTranferDot(form).then((res) => {\r\n\t\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\t\tthis.$emit('update:visible', false)\r\n\t\t\t\t\t\t\tthis.$emit('editSuccess', form)\r\n\t\t\t\t\t\t\tthis.queryUserInfo()\r\n\t\t\t\t\t\t\tmessage({\r\n\t\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\t\tmessage: this.$t('merchant_accountinfo_components_recharge_738')\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n",null]}