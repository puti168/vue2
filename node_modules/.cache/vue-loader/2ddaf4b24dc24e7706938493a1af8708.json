{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\merchant\\merchantInfo\\components\\Setting.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\merchant\\merchantInfo\\components\\Setting.vue","mtime":1616384580093},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport dayjs from 'dayjs'\r\nimport { decimalValidate } from '@/utils/validate'\r\nexport default {\r\n\tname: 'EditTrial',\r\n\tprops: {\r\n\t\taccountData: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: () => {}\r\n\t\t},\r\n\t\tvalue: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t},\r\n\t\tsettingSuccess: {\r\n\t\t\ttype: Function,\r\n\t\t\tdefault: function() {}\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tapiRateStatus: true,\r\n\t\t\tcountPercentageStatus: true,\r\n\t\t\tapiRateData: [],\r\n\t\t\tdotData: [],\r\n\t\t\tshowApiRate: false,\r\n\t\t\tshowDot: false,\r\n\t\t\tinsideLoading: false,\r\n\t\t\tapiRate: '',\r\n\t\t\tcountPercentage: '',\r\n\t\t\taccountForm: {\r\n\t\t\t\tmodel: 2,\r\n\t\t\t\tagentName: '',\r\n\t\t\t\tapiRate: '',\r\n\t\t\t\tcooperations: []\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\tpickerOptionsM() {\r\n\t\t\tconst _this = this\r\n\t\t\treturn {\r\n\t\t\t\tdisabledDate(time) {\r\n\t\t\t\t\tconst now = dayjs()\r\n\t\t\t\t\t\t.endOf('day')\r\n\t\t\t\t\t\t.valueOf()\r\n\t\t\t\t\treturn time.getTime() < now\r\n\t\t\t\t},\r\n\t\t\t\tonPick({ maxDate, minDate }) {\r\n\t\t\t\t\tif (!maxDate) {\r\n\t\t\t\t\t\t_this.minDate = minDate\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\taccountFormRules() {\r\n\t\t\tconst countPercentageValidate = (rule, value, callback) => {\r\n\t\t\t\tif (!decimalValidate(value) || Number(value) === 0 || Number(value) > 100) {\r\n\t\t\t\t\tcallback(\r\n\t\t\t\t\t\tnew Error(this.$t('merchant_merchantinfo_components_editaccount_961'))\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst apiRateValidate = (rule, value, callback) => {\r\n\t\t\t\tif (!decimalValidate(value) || Number(value) === 0 || Number(value) > 100) {\r\n\t\t\t\t\tcallback(\r\n\t\t\t\t\t\tnew Error(this.$t('merchant_merchantinfo_components_editaccount_962'))\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\tapiRate: [{ required: true, validator: apiRateValidate, trigger: 'blur' }],\r\n\t\t\t\tcountPercentage: [\r\n\t\t\t\t\t{ required: true, validator: countPercentageValidate, trigger: 'blur' }\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\taccountData(val) {\r\n\t\t\tthis.accountForm = {\r\n\t\t\t\t...val,\r\n\t\t\t\tcooperations: val.cooperationModel === 1 ? [2, 3] : [val.cooperationModel],\r\n\t\t\t\trateSharingEffectiveDate: val.rateSharingEffectiveDate\r\n\t\t\t\t\t? dayjs(val.rateSharingEffectiveDate).valueOf()\r\n\t\t\t\t\t: new Date().valueOf() + 3600000,\r\n\t\t\t\tbuyCreditsEffectiveDate: val.buyCreditsEffectiveDate\r\n\t\t\t\t\t? dayjs(val.buyCreditsEffectiveDate).valueOf()\r\n\t\t\t\t\t: new Date().valueOf() + 3600000\r\n\t\t\t}\r\n\t\t\tthis.apiRate = val.apiRate\r\n\t\t\tthis.countPercentage = val.countPercentage\r\n\t\t},\r\n\t\t'accountForm.countPercentage': {\r\n\t\t\thandler(val) {\r\n\t\t\t\tif (this.accountData.activeStatus !== 0) {\r\n\t\t\t\t\tthis.countPercentageStatus = false\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.countPercentageStatus = true\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdeep: true\r\n\t\t},\r\n\t\t'accountForm.apiRate': {\r\n\t\t\thandler(val) {\r\n\t\t\t\tif (this.accountData.activeStatus !== 0) {\r\n\t\t\t\t\tthis.apiRateStatus = false\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.apiRateStatus = true\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdeep: true\r\n\t\t}\r\n\t},\r\n\tmounted() {},\r\n\tmethods: {\r\n\t\thandleClose() {\r\n\t\t\tthis.$refs.accountForm.clearValidate()\r\n\t\t\tthis.showApiRate = false\r\n\t\t\tthis.showDot = false\r\n\t\t\tthis.$emit('input', false)\r\n\t\t},\r\n\t\t// 根据合作模式的不同，展示不同结算账户\r\n\t\tgetSettlementAccount() {\r\n\t\t\tif (\r\n\t\t\t\tthis.accountForm.cooperations.includes(2) &&\r\n\t\t\t\tthis.accountForm.cooperations.includes(3)\r\n\t\t\t) {\r\n\t\t\t\treturn this.$t('merchant_merchantinfo_components_editaccount_965')\r\n\t\t\t} else if (this.accountForm.cooperations.includes(2)) {\r\n\t\t\t\treturn this.$t('merchant_merchantinfo_components_editaccount_966')\r\n\t\t\t} else if (this.accountForm.cooperations.includes(3)) {\r\n\t\t\t\treturn this.$t('merchant_merchantinfo_components_editaccount_967')\r\n\t\t\t}\r\n\t\t},\r\n\t\tcommitAccount() {\r\n\t\t\tthis.$refs.accountForm.validate((valid) => {\r\n\t\t\t\tif (valid) {\r\n\t\t\t\t\tconst loading = this.$loading({\r\n\t\t\t\t\t\tlock: true,\r\n\t\t\t\t\t\ttext: 'Loading',\r\n\t\t\t\t\t\tspinner: 'el-icon-loading',\r\n\t\t\t\t\t\tbackground: 'rgba(0, 0, 0, 0.7)'\r\n\t\t\t\t\t})\r\n\t\t\t\t\tconst form = {\r\n\t\t\t\t\t\tagentId: this.accountForm.agentId,\r\n\t\t\t\t\t\tapiRate: this.accountForm.apiRate && Number(this.accountForm.apiRate),\r\n\t\t\t\t\t\tcountPercentage:\r\n\t\t\t\t\t\t\tthis.accountForm.countPercentage &&\r\n\t\t\t\t\t\t\tNumber(this.accountForm.countPercentage),\r\n\t\t\t\t\t\tbuyCreditsEffectiveDate:\r\n\t\t\t\t\t\t\tthis.countPercentage\r\n\t\t\t\t\t\t\t\t? String(this.accountForm.buyCreditsEffectiveDate)\r\n\t\t\t\t\t\t\t\t: '',\r\n\t\t\t\t\t\trateSharingEffectiveDate:\r\n\t\t\t\t\t\t\tthis.apiRate\r\n\t\t\t\t\t\t\t\t? String(this.accountForm.rateSharingEffectiveDate)\r\n\t\t\t\t\t\t\t\t: ''\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.$api\r\n\t\t\t\t\t\t.agentAccountSet(form)\r\n\t\t\t\t\t\t.then((_) => {\r\n\t\t\t\t\t\t\tif (_.code === 200) {\r\n\t\t\t\t\t\t\t\tthis.$emit('input', false)\r\n\t\t\t\t\t\t\t\tif (this.accountForm.activeStatus === 0) {\r\n\t\t\t\t\t\t\t\t\tthis.$emit('settingSuccess', this.accountForm)\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tif ((!this.apiRate && this.accountForm.apiRate) || (!this.countPercentage && this.accountForm.countPercentage)) {\r\n\t\t\t\t\t\t\t\t\t\tthis.$emit('settingSuccess', this.accountForm)\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tthis.$emit('settingSuccess')\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\t\t\tmessage: this.$t(\r\n\t\t\t\t\t\t\t\t\t\tthis.$t('merchant_merchantinfo_components_edittrial_987')\r\n\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\ttype: 'success'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tloading.close()\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch(() => {\r\n\t\t\t\t\t\t\tloading.close()\r\n\t\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\tchangeTable(value) {\r\n\t\t\tthis[value] = !this[value]\r\n\t\t\tthis.insideLoading = true\r\n\t\t\tif (this[value] && value === 'showApiRate') {\r\n\t\t\t\tthis.$api\r\n\t\t\t\t\t.getRateApiHistory({ agentId: this.accountForm.agentId })\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\t\tthis.apiRateData = res.data || []\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.insideLoading = false\r\n\t\t\t\t\t}).catch(() => {\r\n\t\t\t\t\t\tthis.insideLoading = false\r\n\t\t\t\t\t})\r\n\t\t\t} else if (this[value]) {\r\n\t\t\t\tthis.$api\r\n\t\t\t\t\t.getCountPercentageHistory({ agentId: this.accountForm.agentId })\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\t\tthis.dotData = res.data || []\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.insideLoading = false\r\n\t\t\t\t\t}).catch(() => {\r\n\t\t\t\t\t\tthis.insideLoading = false\r\n\t\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n",null]}