{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\merchant\\merchantInfo\\components\\KeysManage.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\merchant\\merchantInfo\\components\\KeysManage.vue","mtime":1616384580085},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { mapGetters } from 'vuex'\r\nimport list from '@/mixins/list'\r\nimport { message } from '@/utils/message'\r\n\r\nexport default {\r\n\tname: 'KeysManage',\r\n\tmixins: [list],\r\n\tprops: {\r\n\t\taccountData: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: () => {}\r\n\t\t},\r\n\t\tvalue: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tdialogVisible: false,\r\n\t\t\trecordLoading: false,\r\n\t\t\tcurrentData: {},\r\n\t\t\tfilterType: null,\r\n\t\t\tlastOne: false,\r\n\t\t\tagentName: '',\r\n\t\t\tlist: [],\r\n\t\t\tpassword: ''\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapGetters(['globalDics']),\r\n\t\tagenttype() {\r\n\t\t\treturn this.globalDics.agenttype\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\tvalue(val) {\r\n\t\t\tif (val) {\r\n\t\t\t\tthis.listKeys()\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmounted() {},\r\n\tmethods: {\r\n\t\tlistKeys() {\r\n\t\t\tthis.$api\r\n\t\t\t\t.searchKey({\r\n\t\t\t\t\tpageIndex: this.pageIndex,\r\n\t\t\t\t\tpageSize: this.pageSize,\r\n\t\t\t\t\tagentId: this.accountData.agentId\r\n\t\t\t\t})\r\n\t\t\t\t.then((res) => {\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tconst data = res.data\r\n\t\t\t\t\t\tthis.list = data.record\r\n\t\t\t\t\t\tthis.total = data.totalRecord\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t},\r\n\t\thandleCurrentChange() {\r\n\t\t\tthis.listKeys()\r\n\t\t},\r\n\t\thandleSizeChange(value) {\r\n\t\t\tthis.pageSize = value\r\n\t\t\tlocalStorage.setItem('pageSize', value)\r\n\t\t\tthis.listKeys()\r\n\t\t},\r\n\t\thandleClose() {\r\n\t\t\tthis.$emit('input', false)\r\n\t\t},\r\n\t\tfilterMerchantType(type) {\r\n\t\t\tif (type) {\r\n\t\t\t\treturn (\r\n\t\t\t\t\tthis.agenttype.filter((item) => item.value === Number(type))[0] &&\r\n\t\t\t\t\tthis.agenttype.filter((item) => item.value === Number(type))[0].text\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t},\r\n\t\tgenerateKey() {\r\n\t\t\tthis.$api\r\n\t\t\t\t.newAgentKey({\r\n\t\t\t\t\tagentCode: this.accountData.agentCode,\r\n\t\t\t\t\tagentId: this.accountData.agentId,\r\n\t\t\t\t\tagentName: this.accountData.agentName\r\n\t\t\t\t})\r\n\t\t\t\t.then((res) => {\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tthis.listKeys()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t},\r\n\t\tdisableKey(row) {\r\n\t\t\tthis.currentData = { ...row }\r\n\t\t\tthis.dialogVisible = true\r\n\t\t\tthis.password = ''\r\n\t\t\tconst filterLists = this.list.filter((val) => val.status === 1) || []\r\n\t\t\tif (filterLists.length === 1) {\r\n\t\t\t\tthis.lastOne = true\r\n\t\t\t} else {\r\n\t\t\t\tthis.lastOne = false\r\n\t\t\t}\r\n\t\t},\r\n\t\thandleSure() {\r\n\t\t\tif (!this.lastOne) {\r\n\t\t\t\tif (!this.password) {\r\n\t\t\t\t\treturn message({\r\n\t\t\t\t\t\tmessage: this.$t('merchant_merchantinfo_components_keysmanage_1003'),\r\n\t\t\t\t\t\ttype: 'error'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tthis.$api\r\n\t\t\t\t\t.stopAgentKey({\r\n\t\t\t\t\t\tagentCode: this.currentData.agentCode,\r\n\t\t\t\t\t\tagentId: this.currentData.agentId,\r\n\t\t\t\t\t\tid: this.currentData.id,\r\n\t\t\t\t\t\tpwd: this.password\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\t\tconst index = this.list.findIndex(\r\n\t\t\t\t\t\t\t\t(val) => val.id === this.currentData.id\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\tthis.list[index].status = 0\r\n\t\t\t\t\t\t\tmessage({\r\n\t\t\t\t\t\t\t\tmessage: this.$t('merchant_merchantinfo_components_keysmanage_1004'),\r\n\t\t\t\t\t\t\t\ttype: 'success'\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tthis.dialogVisible = false\r\n\t\t},\r\n\t\thandleCancle() {\r\n\t\t\tthis.lastOne = false\r\n\t\t\tthis.dialogVisible = false\r\n\t\t}\r\n\t}\r\n}\r\n",null]}