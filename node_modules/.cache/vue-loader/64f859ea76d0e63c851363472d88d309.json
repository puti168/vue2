{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\components\\MultiTab\\MultiTab.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\components\\MultiTab\\MultiTab.vue","mtime":1617594855289},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgZXZlbnRzIGZyb20gJy4vZXZlbnRzJw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdNdWx0aVRhYicsDQogIGRhdGEgKCkgew0KICAgIHJldHVybiB7DQogICAgICBmdWxsUGF0aExpc3Q6IFtdLA0KICAgICAgcGFnZXM6IFtdLA0KICAgICAgYWN0aXZlS2V5OiAnJywNCiAgICAgIG5ld1RhYkluZGV4OiAwDQogICAgfQ0KICB9LA0KICBjcmVhdGVkICgpIHsNCiAgICAvLyBiaW5kIGV2ZW50DQogICAgZXZlbnRzLiRvbignb3BlbicsIHZhbCA9PiB7DQogICAgICBpZiAoIXZhbCkgew0KICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYG11bHRpLXRhYjogb3BlbiB0YWIgJHt2YWx9IGVycmApDQogICAgICB9DQogICAgICB0aGlzLmFjdGl2ZUtleSA9IHZhbA0KICAgIH0pLiRvbignY2xvc2UnLCB2YWwgPT4gew0KICAgICAgaWYgKCF2YWwpIHsNCiAgICAgICAgdGhpcy5jbG9zZVRoYXQodGhpcy5hY3RpdmVLZXkpDQogICAgICAgIHJldHVybg0KICAgICAgfQ0KICAgICAgdGhpcy5jbG9zZVRoYXQodmFsKQ0KICAgIH0pLiRvbigncmVuYW1lJywgKHsga2V5LCBuYW1lIH0pID0+IHsNCiAgICAgIGNvbnNvbGUubG9nKCdyZW5hbWUnLCBrZXksIG5hbWUpDQogICAgICB0cnkgew0KICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5wYWdlcy5maW5kKGl0ZW0gPT4gaXRlbS5wYXRoID09PSBrZXkpDQogICAgICAgIGl0ZW0ubWV0YS5jdXN0b21UaXRsZSA9IG5hbWUNCiAgICAgICAgdGhpcy4kZm9yY2VVcGRhdGUoKQ0KICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgfQ0KICAgIH0pDQoNCiAgICB0aGlzLnBhZ2VzLnB1c2godGhpcy4kcm91dGUpDQogICAgdGhpcy5mdWxsUGF0aExpc3QucHVzaCh0aGlzLiRyb3V0ZS5mdWxsUGF0aCkNCiAgICB0aGlzLnNlbGVjdGVkTGFzdFBhdGgoKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgb25FZGl0ICh0YXJnZXRLZXksIGFjdGlvbikgew0KICAgICAgdGhpc1thY3Rpb25dKHRhcmdldEtleSkNCiAgICB9LA0KICAgIHJlbW92ZSAodGFyZ2V0S2V5KSB7DQogICAgICB0aGlzLnBhZ2VzID0gdGhpcy5wYWdlcy5maWx0ZXIocGFnZSA9PiBwYWdlLmZ1bGxQYXRoICE9PSB0YXJnZXRLZXkpDQogICAgICB0aGlzLmZ1bGxQYXRoTGlzdCA9IHRoaXMuZnVsbFBhdGhMaXN0LmZpbHRlcihwYXRoID0+IHBhdGggIT09IHRhcmdldEtleSkNCiAgICAgIC8vIOWIpOaWreW9k+WJjeagh+etvuaYr+WQpuWFs+mXre+8jOiLpeWFs+mXreWImei3s+i9rOWIsOacgOWQjuS4gOS4qui/mOWtmOWcqOeahOagh+etvumhtQ0KICAgICAgaWYgKCF0aGlzLmZ1bGxQYXRoTGlzdC5pbmNsdWRlcyh0aGlzLmFjdGl2ZUtleSkpIHsNCiAgICAgICAgdGhpcy5zZWxlY3RlZExhc3RQYXRoKCkNCiAgICAgIH0NCiAgICB9LA0KICAgIHNlbGVjdGVkTGFzdFBhdGggKCkgew0KICAgICAgdGhpcy5hY3RpdmVLZXkgPSB0aGlzLmZ1bGxQYXRoTGlzdFt0aGlzLmZ1bGxQYXRoTGlzdC5sZW5ndGggLSAxXQ0KICAgIH0sDQoNCiAgICAvLyBjb250ZW50IG1lbnUNCiAgICBjbG9zZVRoYXQgKGUpIHsNCiAgICAgIC8vIOWIpOaWreaYr+WQpuS4uuacgOWQjuS4gOS4quagh+etvumhte+8jOWmguaenOaYr+acgOWQjuS4gOS4qu+8jOWImeaXoOazleiiq+WFs+mXrQ0KICAgICAgaWYgKHRoaXMuZnVsbFBhdGhMaXN0Lmxlbmd0aCA+IDEpIHsNCiAgICAgICAgdGhpcy5yZW1vdmUoZSkNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2UuaW5mbygn6L+Z5piv5pyA5ZCO5LiA5Liq5qCH562+5LqGLCDml6Dms5XooqvlhbPpl60nKQ0KICAgICAgfQ0KICAgIH0sDQogICAgY2xvc2VMZWZ0IChlKSB7DQogICAgICBjb25zdCBjdXJyZW50SW5kZXggPSB0aGlzLmZ1bGxQYXRoTGlzdC5pbmRleE9mKGUpDQogICAgICBpZiAoY3VycmVudEluZGV4ID4gMCkgew0KICAgICAgICB0aGlzLmZ1bGxQYXRoTGlzdC5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4gew0KICAgICAgICAgIGlmIChpbmRleCA8IGN1cnJlbnRJbmRleCkgew0KICAgICAgICAgICAgdGhpcy5yZW1vdmUoaXRlbSkNCiAgICAgICAgICB9DQogICAgICAgIH0pDQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLiRtZXNzYWdlLmluZm8oJ+W3puS+p+ayoeacieagh+etvicpDQogICAgICB9DQogICAgfSwNCiAgICBjbG9zZVJpZ2h0IChlKSB7DQogICAgICBjb25zdCBjdXJyZW50SW5kZXggPSB0aGlzLmZ1bGxQYXRoTGlzdC5pbmRleE9mKGUpDQogICAgICBpZiAoY3VycmVudEluZGV4IDwgKHRoaXMuZnVsbFBhdGhMaXN0Lmxlbmd0aCAtIDEpKSB7DQogICAgICAgIHRoaXMuZnVsbFBhdGhMaXN0LmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7DQogICAgICAgICAgaWYgKGluZGV4ID4gY3VycmVudEluZGV4KSB7DQogICAgICAgICAgICB0aGlzLnJlbW92ZShpdGVtKQ0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2UuaW5mbygn5Y+z5L6n5rKh5pyJ5qCH562+JykNCiAgICAgIH0NCiAgICB9LA0KICAgIGNsb3NlQWxsIChlKSB7DQogICAgICBjb25zdCBjdXJyZW50SW5kZXggPSB0aGlzLmZ1bGxQYXRoTGlzdC5pbmRleE9mKGUpDQogICAgICB0aGlzLmZ1bGxQYXRoTGlzdC5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4gew0KICAgICAgICBpZiAoaW5kZXggIT09IGN1cnJlbnRJbmRleCkgew0KICAgICAgICAgIHRoaXMucmVtb3ZlKGl0ZW0pDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICBjbG9zZU1lbnVDbGljayAoa2V5LCByb3V0ZSkgew0KICAgICAgdGhpc1trZXldKHJvdXRlKQ0KICAgIH0sDQogICAgcmVuZGVyVGFiUGFuZU1lbnUgKGUpIHsNCiAgICAgIHJldHVybiAoDQogICAgICAgIDxhLW1lbnUgey4uLnsgb246IHsgY2xpY2s6ICh7IGtleSwgaXRlbSwgZG9tRXZlbnQgfSkgPT4geyB0aGlzLmNsb3NlTWVudUNsaWNrKGtleSwgZSkgfSB9IH19Pg0KICAgICAgICAgIDxhLW1lbnUtaXRlbSBrZXk9ImNsb3NlVGhhdCI+5YWz6Zet5b2T5YmN5qCH562+PC9hLW1lbnUtaXRlbT4NCiAgICAgICAgICA8YS1tZW51LWl0ZW0ga2V5PSJjbG9zZVJpZ2h0Ij7lhbPpl63lj7Pkvqc8L2EtbWVudS1pdGVtPg0KICAgICAgICAgIDxhLW1lbnUtaXRlbSBrZXk9ImNsb3NlTGVmdCI+5YWz6Zet5bem5L6nPC9hLW1lbnUtaXRlbT4NCiAgICAgICAgICA8YS1tZW51LWl0ZW0ga2V5PSJjbG9zZUFsbCI+5YWz6Zet5YWo6YOoPC9hLW1lbnUtaXRlbT4NCiAgICAgICAgPC9hLW1lbnU+DQogICAgICApDQogICAgfSwNCiAgICAvLyByZW5kZXINCiAgICByZW5kZXJUYWJQYW5lICh0aXRsZSwga2V5UGF0aCkgew0KICAgICAgY29uc3QgbWVudSA9IHRoaXMucmVuZGVyVGFiUGFuZU1lbnUoa2V5UGF0aCkNCg0KICAgICAgcmV0dXJuICgNCiAgICAgICAgPGEtZHJvcGRvd24gb3ZlcmxheT17bWVudX0gdHJpZ2dlcj17Wydjb250ZXh0bWVudSddfT4NCiAgICAgICAgICA8c3BhbiBzdHlsZT17eyB1c2VyU2VsZWN0OiAnbm9uZScgfX0+eyB0aXRsZSB9PC9zcGFuPg0KICAgICAgICA8L2EtZHJvcGRvd24+DQogICAgICApDQogICAgfQ0KICB9LA0KICB3YXRjaDogew0KICAgICckcm91dGUnOiBmdW5jdGlvbiAobmV3VmFsKSB7DQogICAgICB0aGlzLmFjdGl2ZUtleSA9IG5ld1ZhbC5mdWxsUGF0aA0KICAgICAgaWYgKHRoaXMuZnVsbFBhdGhMaXN0LmluZGV4T2YobmV3VmFsLmZ1bGxQYXRoKSA8IDApIHsNCiAgICAgICAgdGhpcy5mdWxsUGF0aExpc3QucHVzaChuZXdWYWwuZnVsbFBhdGgpDQogICAgICAgIHRoaXMucGFnZXMucHVzaChuZXdWYWwpDQogICAgICB9DQogICAgfSwNCiAgICBhY3RpdmVLZXk6IGZ1bmN0aW9uIChuZXdQYXRoS2V5KSB7DQogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IHBhdGg6IG5ld1BhdGhLZXkgfSkNCiAgICB9DQogIH0sDQogIHJlbmRlciAoKSB7DQogICAgY29uc3QgeyBvbkVkaXQsICRkYXRhOiB7IHBhZ2VzIH0gfSA9IHRoaXMNCiAgICBjb25zdCBwYW5lcyA9IHBhZ2VzLm1hcChwYWdlID0+IHsNCiAgICAgIHJldHVybiAoDQogICAgICAgIDxhLXRhYi1wYW5lDQogICAgICAgICAgc3R5bGU9e3sgaGVpZ2h0OiAwIH19DQogICAgICAgICAgdGFiPXt0aGlzLnJlbmRlclRhYlBhbmUocGFnZS5tZXRhLmN1c3RvbVRpdGxlIHx8IHBhZ2UubWV0YS50aXRsZSwgcGFnZS5mdWxsUGF0aCl9DQogICAgICAgICAga2V5PXtwYWdlLmZ1bGxQYXRofSBjbG9zYWJsZT17cGFnZXMubGVuZ3RoID4gMX0NCiAgICAgICAgPg0KICAgICAgICA8L2EtdGFiLXBhbmU+KQ0KICAgIH0pDQoNCiAgICByZXR1cm4gKA0KICAgICAgPGRpdiBjbGFzcz0iYW50LXByby1tdWx0aS10YWIiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJhbnQtcHJvLW11bHRpLXRhYi13cmFwcGVyIj4NCiAgICAgICAgICA8YS10YWJzDQogICAgICAgICAgICBoaWRlQWRkDQogICAgICAgICAgICB0eXBlPXsnZWRpdGFibGUtY2FyZCd9DQogICAgICAgICAgICB2LW1vZGVsPXt0aGlzLmFjdGl2ZUtleX0NCiAgICAgICAgICAgIHRhYkJhclN0eWxlPXt7IGJhY2tncm91bmQ6ICcjRkZGJywgbWFyZ2luOiAwLCBwYWRkaW5nTGVmdDogJzE2cHgnLCBwYWRkaW5nVG9wOiAnMXB4JyB9fQ0KICAgICAgICAgICAgey4uLnsgb246IHsgZWRpdDogb25FZGl0IH0gfX0+DQogICAgICAgICAgICB7cGFuZXN9DQogICAgICAgICAgPC9hLXRhYnM+DQogICAgICAgIDwvZGl2Pg0KICAgICAgPC9kaXY+DQogICAgKQ0KICB9DQp9DQo="},{"version":3,"sources":["MultiTab.vue"],"names":[],"mappings":";AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MultiTab.vue","sourceRoot":"src/components/MultiTab","sourcesContent":["<script>\r\nimport events from './events'\r\n\r\nexport default {\r\n  name: 'MultiTab',\r\n  data () {\r\n    return {\r\n      fullPathList: [],\r\n      pages: [],\r\n      activeKey: '',\r\n      newTabIndex: 0\r\n    }\r\n  },\r\n  created () {\r\n    // bind event\r\n    events.$on('open', val => {\r\n      if (!val) {\r\n        throw new Error(`multi-tab: open tab ${val} err`)\r\n      }\r\n      this.activeKey = val\r\n    }).$on('close', val => {\r\n      if (!val) {\r\n        this.closeThat(this.activeKey)\r\n        return\r\n      }\r\n      this.closeThat(val)\r\n    }).$on('rename', ({ key, name }) => {\r\n      console.log('rename', key, name)\r\n      try {\r\n        const item = this.pages.find(item => item.path === key)\r\n        item.meta.customTitle = name\r\n        this.$forceUpdate()\r\n      } catch (e) {\r\n      }\r\n    })\r\n\r\n    this.pages.push(this.$route)\r\n    this.fullPathList.push(this.$route.fullPath)\r\n    this.selectedLastPath()\r\n  },\r\n  methods: {\r\n    onEdit (targetKey, action) {\r\n      this[action](targetKey)\r\n    },\r\n    remove (targetKey) {\r\n      this.pages = this.pages.filter(page => page.fullPath !== targetKey)\r\n      this.fullPathList = this.fullPathList.filter(path => path !== targetKey)\r\n      // 判断当前标签是否关闭，若关闭则跳转到最后一个还存在的标签页\r\n      if (!this.fullPathList.includes(this.activeKey)) {\r\n        this.selectedLastPath()\r\n      }\r\n    },\r\n    selectedLastPath () {\r\n      this.activeKey = this.fullPathList[this.fullPathList.length - 1]\r\n    },\r\n\r\n    // content menu\r\n    closeThat (e) {\r\n      // 判断是否为最后一个标签页，如果是最后一个，则无法被关闭\r\n      if (this.fullPathList.length > 1) {\r\n        this.remove(e)\r\n      } else {\r\n        this.$message.info('这是最后一个标签了, 无法被关闭')\r\n      }\r\n    },\r\n    closeLeft (e) {\r\n      const currentIndex = this.fullPathList.indexOf(e)\r\n      if (currentIndex > 0) {\r\n        this.fullPathList.forEach((item, index) => {\r\n          if (index < currentIndex) {\r\n            this.remove(item)\r\n          }\r\n        })\r\n      } else {\r\n        this.$message.info('左侧没有标签')\r\n      }\r\n    },\r\n    closeRight (e) {\r\n      const currentIndex = this.fullPathList.indexOf(e)\r\n      if (currentIndex < (this.fullPathList.length - 1)) {\r\n        this.fullPathList.forEach((item, index) => {\r\n          if (index > currentIndex) {\r\n            this.remove(item)\r\n          }\r\n        })\r\n      } else {\r\n        this.$message.info('右侧没有标签')\r\n      }\r\n    },\r\n    closeAll (e) {\r\n      const currentIndex = this.fullPathList.indexOf(e)\r\n      this.fullPathList.forEach((item, index) => {\r\n        if (index !== currentIndex) {\r\n          this.remove(item)\r\n        }\r\n      })\r\n    },\r\n    closeMenuClick (key, route) {\r\n      this[key](route)\r\n    },\r\n    renderTabPaneMenu (e) {\r\n      return (\r\n        <a-menu {...{ on: { click: ({ key, item, domEvent }) => { this.closeMenuClick(key, e) } } }}>\r\n          <a-menu-item key=\"closeThat\">关闭当前标签</a-menu-item>\r\n          <a-menu-item key=\"closeRight\">关闭右侧</a-menu-item>\r\n          <a-menu-item key=\"closeLeft\">关闭左侧</a-menu-item>\r\n          <a-menu-item key=\"closeAll\">关闭全部</a-menu-item>\r\n        </a-menu>\r\n      )\r\n    },\r\n    // render\r\n    renderTabPane (title, keyPath) {\r\n      const menu = this.renderTabPaneMenu(keyPath)\r\n\r\n      return (\r\n        <a-dropdown overlay={menu} trigger={['contextmenu']}>\r\n          <span style={{ userSelect: 'none' }}>{ title }</span>\r\n        </a-dropdown>\r\n      )\r\n    }\r\n  },\r\n  watch: {\r\n    '$route': function (newVal) {\r\n      this.activeKey = newVal.fullPath\r\n      if (this.fullPathList.indexOf(newVal.fullPath) < 0) {\r\n        this.fullPathList.push(newVal.fullPath)\r\n        this.pages.push(newVal)\r\n      }\r\n    },\r\n    activeKey: function (newPathKey) {\r\n      this.$router.push({ path: newPathKey })\r\n    }\r\n  },\r\n  render () {\r\n    const { onEdit, $data: { pages } } = this\r\n    const panes = pages.map(page => {\r\n      return (\r\n        <a-tab-pane\r\n          style={{ height: 0 }}\r\n          tab={this.renderTabPane(page.meta.customTitle || page.meta.title, page.fullPath)}\r\n          key={page.fullPath} closable={pages.length > 1}\r\n        >\r\n        </a-tab-pane>)\r\n    })\r\n\r\n    return (\r\n      <div class=\"ant-pro-multi-tab\">\r\n        <div class=\"ant-pro-multi-tab-wrapper\">\r\n          <a-tabs\r\n            hideAdd\r\n            type={'editable-card'}\r\n            v-model={this.activeKey}\r\n            tabBarStyle={{ background: '#FFF', margin: 0, paddingLeft: '16px', paddingTop: '1px' }}\r\n            {...{ on: { edit: onEdit } }}>\r\n            {panes}\r\n          </a-tabs>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n</script>\r\n"]}]}