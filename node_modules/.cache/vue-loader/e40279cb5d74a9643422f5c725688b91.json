{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\merchant\\merchantInfo\\components\\EditAccount.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\merchant\\merchantInfo\\components\\EditAccount.vue","mtime":1616384580083},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { decimalValidate } from '@/utils/validate'\r\nimport { IsURL } from '@/utils'\r\nimport { mapGetters } from 'vuex'\r\nimport dayjs from 'dayjs'\r\n\r\nexport default {\r\n\tname: 'EditAccount',\r\n\tprops: {\r\n\t\tcloneApiRate: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0\r\n\t\t},\r\n\t\tcloneCountPercentage: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0\r\n\t\t},\r\n\t\taccountData: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: () => {}\r\n\t\t},\r\n\t\tvalue: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t},\r\n\t\tcurrency: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: function() {\r\n\t\t\t\treturn []\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tmodalVisible: false,\r\n\t\t\tshowApiRate: false,\r\n\t\t\tshowDot: false,\r\n\t\t\tapiRateData: [],\r\n\t\t\tdotData: [],\r\n\t\t\taccountForm: {\r\n\t\t\t\tagentName: '',\r\n\t\t\t\tapiRate: '',\r\n\t\t\t\tcooperations: [],\r\n\t\t\t\tbuyCreditsEffectiveDate: '',\r\n\t\t\t\tverifyCodeType: 1,\r\n\t\t\t\twalletType: 0,\r\n\t\t\t\tmerchantType: 1\r\n\t\t\t},\r\n\t\t\tcountPercentageStatus: true,\r\n\t\t\tapiRateStatus: true,\r\n\t\t\tshowGoogleCode: true,\r\n\t\t\tbetLimits: []\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapGetters(['globalDics', 'userInfo']),\r\n\t\twalletmodels() {\r\n\t\t\treturn this.globalDics.walletmodel\r\n\t\t},\r\n\t\tagenttype() {\r\n\t\t\treturn this.globalDics.agenttype\r\n\t\t},\r\n\t\taccountFormRules() {\r\n\t\t\t/* eslint-disable */\r\n\t\t\tconst validateAgentName = async (rule, value, callback) => {\r\n\t\t\t\tif (this.accountForm.type === 1) {\r\n\t\t\t\t\tconst result = await this.$api.checkAgentNameConflict({\r\n\t\t\t\t\t\tagentName: value,\r\n\t\t\t\t\t\tagentId: this.accountData.agentId\r\n\t\t\t\t\t})\r\n\t\t\t\t\tif (result.data === 1) {\r\n\t\t\t\t\t\tcallback(\r\n\t\t\t\t\t\t\tnew Error(this.$t('merchant_merchantinfo_components_editaccount_957'))\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t} else if (!/^[[a-zA-Z0-9\\u4e00-\\u9fa5]+$/.test(value)) {\r\n\t\t\t\t\t\tcallback(\r\n\t\t\t\t\t\t\tnew Error(this.$t('merchant_merchantinfo_components_editaccount_958'))\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t} else if (value.length > 20) {\r\n\t\t\t\t\t\tcallback(\r\n\t\t\t\t\t\t\tnew Error(this.$t('merchant_merchantinfo_components_editaccount_959'))\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t} else if (value.length < 2) {\r\n\t\t\t\t\t\tcallback(\r\n\t\t\t\t\t\t\tnew Error(this.$t('merchant_merchantinfo_components_editaccount_960'))\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcallback()\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!/^[[a-zA-Z0-9\\u4e00-\\u9fa5]+$/.test(value)) {\r\n\t\t\t\t\t\tcallback(\r\n\t\t\t\t\t\t\tnew Error(this.$t('merchant_merchantinfo_components_editaccount_958'))\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t} else if (value.length > 20) {\r\n\t\t\t\t\t\tcallback(\r\n\t\t\t\t\t\t\tnew Error(this.$t('merchant_merchantinfo_components_editaccount_959'))\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t} else if (value.length < 2) {\r\n\t\t\t\t\t\tcallback(\r\n\t\t\t\t\t\t\tnew Error(this.$t('merchant_merchantinfo_components_editaccount_960'))\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcallback()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst countPercentageValidate = (rule, value, callback) => {\r\n\t\t\t\tif (!decimalValidate(value) || Number(value) === 0 || Number(value) > 100) {\r\n\t\t\t\t\tcallback(\r\n\t\t\t\t\t\tnew Error(this.$t('merchant_merchantinfo_components_editaccount_961'))\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst apiRateValidate = (rule, value, callback) => {\r\n\t\t\t\tif (!decimalValidate(value) || Number(value) === 0 || Number(value) > 100) {\r\n\t\t\t\t\tcallback(\r\n\t\t\t\t\t\tnew Error(this.$t('merchant_merchantinfo_components_editaccount_962'))\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\tagentName: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\ttrigger: 'blur',\r\n\t\t\t\t\t\tmessage: this.$t('merchant_merchantinfo_components_editaccount_963')\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvalidator: validateAgentName,\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\tapiRate: [{ required: true, validator: apiRateValidate, trigger: 'blur' }],\r\n\t\t\t\tcountPercentage: [\r\n\t\t\t\t\t{ required: true, validator: countPercentageValidate, trigger: 'blur' }\r\n\t\t\t\t],\r\n\t\t\t\twalletType: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\tmessage: this.$t('merchant.merchant_87'),\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\twalletUrl: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttrigger: 'blur',\r\n\t\t\t\t\t\tvalidator: (rule, value, callback) => {\r\n\t\t\t\t\t\t\tif (!value || (IsURL(value) && value.length <= 255)) {\r\n\t\t\t\t\t\t\t\tcallback()\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tcallback(\r\n\t\t\t\t\t\t\t\t\tnew Error(this.$t('merchant_merchantinfo_components_editaccount_964'))\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\tvalue(val) {\r\n\t\t\tthis.modalVisible = val\r\n\t\t},\r\n\t\taccountData(val) {\r\n\t\t\tthis.accountForm = {\r\n\t\t\t\t...val,\r\n\t\t\t\tcooperations: val.cooperationModel === 1 ? [2, 3] : [val.cooperationModel],\r\n\t\t\t\trateSharingEffectiveDate: val.rateSharingEffectiveDate\r\n\t\t\t\t\t? dayjs(val.rateSharingEffectiveDate).valueOf()\r\n\t\t\t\t\t: new Date().valueOf(),\r\n\t\t\t\tbuyCreditsEffectiveDate: val.buyCreditsEffectiveDate\r\n\t\t\t\t\t? dayjs(val.buyCreditsEffectiveDate).valueOf()\r\n\t\t\t\t\t: new Date().valueOf(),\r\n\t\t\t\tverifyCodeType: val.verifyCodeType,\r\n\t\t\t\tnewPlayerLimitRed: val.newPlayerLimitRed\r\n\t\t\t}\r\n\t\t\tthis.showGoogleCode = val.verifyCodeType === 1\r\n\t\t\tthis.loadBetLimitList()\r\n\t\t},\r\n\t\t'accountForm.apiRate': {\r\n\t\t\thandler(val) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tval &&\r\n\t\t\t\t\tNumber(val) !== Number(this.cloneApiRate) &&\r\n\t\t\t\t\tthis.accountData.cooperationModel !== 3\r\n\t\t\t\t) {\r\n\t\t\t\t\tthis.apiRateStatus = false\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.apiRateStatus = true\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdeep: true\r\n\t\t},\r\n\t\t'accountForm.countPercentage': {\r\n\t\t\thandler(val) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tval &&\r\n\t\t\t\t\tNumber(val) !== Number(this.cloneCountPercentage) &&\r\n\t\t\t\t\tthis.accountData.cooperationModel !== 2\r\n\t\t\t\t) {\r\n\t\t\t\t\tthis.countPercentageStatus = false\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.countPercentageStatus = true\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdeep: true\r\n\t\t},\r\n\t\t'accountForm.verifyCodeType'(val) {\r\n\t\t\tif (val === 2) {\r\n\t\t\t\tthis.showGoogleCode = false\r\n\t\t\t} else {\r\n\t\t\t\tthis.showGoogleCode = true\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tloadBetLimitList() {\r\n\t\t\t// 自定义限红的type  因为自定义限红暂时隐藏，所以这里传type为 1\r\n\t\t\tconst type = 1\r\n\t\t\tthis.$api.memberBetLimitList({ type }).then((_) => {\r\n\t\t\t\tif (_.code === 200) {\r\n\t\t\t\t\tthis.betLimits = _.data || []\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\tgetGoogleAuth() {\r\n\t\t\tthis.$api.getGoogleAuth().then((res) => {\r\n\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\tthis.accountForm.googleAuthCode = res.data\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\thandleClose() {\r\n\t\t\tthis.showApiRate = false\r\n\t\t\tthis.showDot = false\r\n\t\t\tthis.$refs.accountForm.clearValidate()\r\n\t\t\tthis.$emit('input', false)\r\n\t\t},\r\n\t\tgetCooperation(cooperations = []) {\r\n\t\t\tif (cooperations.length > 1) {\r\n\t\t\t\treturn 1\r\n\t\t\t}\r\n\t\t\treturn cooperations[0]\r\n\t\t},\r\n\t\tcommitAccount() {\r\n\t\t\tthis.$refs.accountForm.validate((valid) => {\r\n\t\t\t\tif (valid) {\r\n\t\t\t\t\tconsole.log(this.accountForm.platformAgent)\r\n\t\t\t\t\tconst form = {\r\n\t\t\t\t\t\t...this.accountForm,\r\n\t\t\t\t\t\tmodel:\r\n\t\t\t\t\t\t\tthis.accountForm.cooperations &&\r\n\t\t\t\t\t\t\tthis.getCooperation(this.accountForm.cooperations),\r\n\t\t\t\t\t\tcooperationModel:\r\n\t\t\t\t\t\t\tthis.accountForm.cooperations &&\r\n\t\t\t\t\t\t\tthis.getCooperation(this.accountForm.cooperations),\r\n\t\t\t\t\t\tcountPercentage:\r\n\t\t\t\t\t\t\tthis.accountForm.countPercentage &&\r\n\t\t\t\t\t\t\tNumber(this.accountForm.countPercentage),\r\n\t\t\t\t\t\t// apiRate: this.accountForm.apiRate && Number(this.accountForm.apiRate),\r\n\t\t\t\t\t\trateSharingEffectiveDate: String(\r\n\t\t\t\t\t\t\tthis.accountForm.rateSharingEffectiveDate\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t\tbuyCreditsEffectiveDate: String(this.accountForm.buyCreditsEffectiveDate),\r\n\t\t\t\t\t\tagentId: this.accountForm.agentId,\r\n\t\t\t\t\t\teditUserName: this.accountForm.adminUserName,\r\n\t\t\t\t\t\tverifyCodeType: this.accountForm.verifyCodeType,\r\n\t\t\t\t\t\tnewPlayerLimitRed: this.accountForm.newPlayerLimitRed\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconsole.log('form :>> ', form)\r\n\r\n\t\t\t\t\tthis.$api.merchantUpdate(form).then((_) => {\r\n\t\t\t\t\t\tif (_.code === 200) {\r\n\t\t\t\t\t\t\tthis.$emit('input', false)\r\n\t\t\t\t\t\t\tform.rateSharingEffectiveDate =\r\n\t\t\t\t\t\t\t\tform.rateSharingEffectiveDate &&\r\n\t\t\t\t\t\t\t\tdayjs(Number(form.rateSharingEffectiveDate)).format(\r\n\t\t\t\t\t\t\t\t\t'YYYY-MM-DD hh:mm:ss'\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\tform.buyCreditsEffectiveDate =\r\n\t\t\t\t\t\t\t\tform.buyCreditsEffectiveDate &&\r\n\t\t\t\t\t\t\t\tdayjs(Number(form.buyCreditsEffectiveDate)).format(\r\n\t\t\t\t\t\t\t\t\t'YYYY-MM-DD hh:mm:ss'\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\tthis.$emit('editSuccess', form)\r\n\t\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\t\tmessage: this.$t('merchant.merchant_88'),\r\n\t\t\t\t\t\t\t\ttype: 'success'\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\tfilterCurrency(type) {\r\n\t\t\tif (!type) return ''\r\n\t\t\treturn this.currency.filter((item) => item.value === type)[0].text\r\n\t\t},\r\n\t\t// 根据合作模式的不同，展示不同结算账户\r\n\t\tgetSettlementAccount() {\r\n\t\t\tif (\r\n\t\t\t\tthis.accountForm.cooperations.includes(2) &&\r\n\t\t\t\tthis.accountForm.cooperations.includes(3)\r\n\t\t\t) {\r\n\t\t\t\treturn this.$t('merchant_merchantinfo_components_editaccount_965')\r\n\t\t\t} else if (this.accountForm.cooperations.includes(2)) {\r\n\t\t\t\treturn this.$t('merchant_merchantinfo_components_editaccount_966')\r\n\t\t\t} else if (this.accountForm.cooperations.includes(3)) {\r\n\t\t\t\treturn this.$t('merchant_merchantinfo_components_editaccount_967')\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 获取货币类型\r\n\t\tgetCurrency() {\r\n\t\t\tconst index = this.currency.findIndex(\r\n\t\t\t\t(val) => Number(val.id) === Number(this.accountForm.currency)\r\n\t\t\t)\r\n\t\t\tif (index > -1) {\r\n\t\t\t\treturn this.currency[index].code\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n",null]}