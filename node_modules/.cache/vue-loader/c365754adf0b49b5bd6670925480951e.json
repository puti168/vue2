{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\authoritymanagement\\agentRelation\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\authoritymanagement\\agentRelation\\index.vue","mtime":1616384580035},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport EditOpen from './components/EditOpen'\r\nimport TableComp from './components/TableComp'\r\nimport SelectAgentTree from '@/components/SelectAgentTree'\r\nimport list from '@/mixins/list'\r\nimport tier from '@/mixins/tier'\r\nimport { routerNames } from '@/utils/consts'\r\nimport { mapGetters } from 'vuex'\r\n\r\nexport default {\r\n\tname: routerNames.agentRelation,\r\n\tcomponents: {\r\n\t\tEditOpen,\r\n\t\tSelectAgentTree,\r\n\t\tTableComp\r\n\t},\r\n\tmixins: [list, tier],\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tmodalType: 1, // 1为启用 2位停用 3为重置密码\r\n\t\t\tloading: false,\r\n\t\t\topenVisible: false,\r\n\t\t\t// model (integer): 合作模式：1、收益分成+购点，2、收益分成，3、购点 ,\r\n\t\t\tmodel: 2,\r\n\t\t\thasSearch: false,\r\n\t\t\tform: {\r\n\t\t\t\tagentId: ''\r\n\t\t\t},\r\n\t\t\tdownForm: {\r\n\t\t\t\ttime: [],\r\n\t\t\t\tagentType: -1,\r\n\t\t\t\tstatus: -1\r\n\t\t\t},\r\n\t\t\tcurrentData: {},\r\n\t\t\topenData: {},\r\n\t\t\tcurrentIndex: -1,\r\n\t\t\tcurrentLevel: 1,\r\n\t\t\t// 商户编码\r\n\t\t\tagentCode: '',\r\n\t\t\tparentAgentId: '',\r\n\t\t\tagentType: '',\r\n\t\t\tdialogShow: false,\r\n\t\t\tshow: true,\r\n\t\t\tagentId: '',\r\n\t\t\tstoreDatas: [],\r\n\t\t\tdata: [],\r\n\t\t\tcurrencyList: []\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapGetters(['userInfo'])\r\n\t},\r\n\twatch: {\r\n\t\tdownForm: {\r\n\t\t\thandler(val) {\r\n\t\t\t\tthis.loadData()\r\n\t\t\t},\r\n\t\t\tdeep: true\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tloadData() {\r\n\t\t\tthis.loading = true\r\n\t\t\tthis.levels = []\r\n\t\t\tconst form = {\r\n\t\t\t\tpageSize: this.pageSize,\r\n\t\t\t\tpageIndex: this.pageIndex,\r\n\t\t\t\tagentId: this.form.agentId,\r\n\t\t\t\ttype: 1\r\n\t\t\t}\r\n\r\n\t\t\tthis.loadCurrenyDate()\r\n\r\n\t\t\tthis.$api\r\n\t\t\t\t.agentRelation(form)\r\n\t\t\t\t.then((_) => {\r\n\t\t\t\t\tthis.loading = false\r\n\t\t\t\t\tif (_.code === 200) {\r\n\t\t\t\t\t\tconst data = _.data\r\n\t\t\t\t\t\tthis.total = data.totalRecord\r\n\t\t\t\t\t\tconst list = data.record\r\n\t\t\t\t\t\tthis.tableLists = [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\topened: false,\r\n\t\t\t\t\t\t\t\ticonLoading: false,\r\n\t\t\t\t\t\t\t\tlevel: 1,\r\n\t\t\t\t\t\t\t\tdata: list\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.catch(() => {\r\n\t\t\t\t\tthis.loading = false\r\n\t\t\t\t})\r\n\t\t},\r\n\t\t/**\r\n\t\t * actType 1为增加 2为修改\r\n\t\t */\r\n\t\tmodifyData(level, params, tableIndex, actType) {\r\n\t\t\tconst extraParams = {\r\n\t\t\t\tstartTime: this.downForm.time && this.downForm.time[0],\r\n\t\t\t\tendTime: this.downForm.time && this.downForm.time[1],\r\n\t\t\t\tagentType: this.downForm.agentType,\r\n\t\t\t\tstatus: this.downForm.status,\r\n\t\t\t\tagentId: params.agentId\r\n\t\t\t}\r\n\r\n\t\t\tthis.mixinModifyData(\r\n\t\t\t\tlevel,\r\n\t\t\t\tparams,\r\n\t\t\t\ttableIndex,\r\n\t\t\t\tactType,\r\n\t\t\t\t'agentRelation',\r\n\t\t\t\textraParams\r\n\t\t\t)\r\n\t\t},\r\n\t\thandleSearch() {\r\n\t\t\tconst extraParams = {}\r\n\t\t\tthis.mixinHandleSearch('agentRelation', extraParams)\r\n\t\t},\r\n\t\tcloseEdit(value) {\r\n\t\t\tthis.$store.dispatch('tree/setTree', [])\r\n\t\t\tthis.$store.dispatch('tree/setTreeData', [])\r\n\t\t\tthis.form.agentId = ''\r\n\t\t\tthis.$refs.tree.initData()\r\n\t\t\tthis.show = false\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.show = true\r\n\t\t\t}, 500)\r\n\t\t\tthis.loadData()\r\n\t\t},\r\n\t\tgenerateTree(data) {\r\n\t\t\tconst datas = [...data]\r\n\t\t\t// 先找出父节点\r\n\t\t\tdatas.forEach((element, i) => {\r\n\t\t\t\tconst index = data.findIndex((val) => val.id === element.parentId)\r\n\t\t\t\tif (index < 0) {\r\n\t\t\t\t\tthis.storeDatas.push({\r\n\t\t\t\t\t\tid: element.id,\r\n\t\t\t\t\t\tlabel: `${element.agentName} ${element.agentCode}`,\r\n\t\t\t\t\t\tchildren: [],\r\n\t\t\t\t\t\t...element\r\n\t\t\t\t\t})\r\n\t\t\t\t\tdatas.splice(i, 1)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.recursionData(datas, this.storeDatas)\r\n\t\t},\r\n\t\t// 递归生成\r\n\t\trecursionData(data, tree) {\r\n\t\t\tconst datas = [...data]\r\n\t\t\tconst pickIndex = []\r\n\t\t\tconst leftDatas = []\r\n\t\t\tdatas.forEach((element) => {\r\n\t\t\t\tconst index = tree.findIndex((val) => val.id === element.parentId)\r\n\t\t\t\tif (index > -1) {\r\n\t\t\t\t\ttree[index].children.push({\r\n\t\t\t\t\t\tid: element.id,\r\n\t\t\t\t\t\tlabel: `${element.agentName} ${element.agentCode}`,\r\n\t\t\t\t\t\tchildren: [],\r\n\t\t\t\t\t\t...element\r\n\t\t\t\t\t})\r\n\t\t\t\t\t!pickIndex.includes(index) && pickIndex.push(index)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tleftDatas.push(element)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tif (pickIndex.length > 0) {\r\n\t\t\t\tpickIndex.forEach((element) => {\r\n\t\t\t\t\tthis.recursionData(leftDatas, tree[element].children)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\thandleReset() {\r\n\t\t\tthis.form = {\r\n\t\t\t\tagentId: ''\r\n\t\t\t}\r\n\t\t\tthis.hasSearch = false\r\n\t\t\tthis.loadData()\r\n\t\t},\r\n\t\teditOpen(index, row, tableData) {\r\n\t\t\tthis.tableLists.forEach((item, index) => {\r\n\t\t\t\tif (item.level === tableData.level) {\r\n\t\t\t\t\tif (item.parentId) {\r\n\t\t\t\t\t\tthis.parentAgentId = item.parentId.split('_')[1]\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.parentAgentId = this.tableLists[index - 1].data[0].agentId.split(\r\n\t\t\t\t\t\t\t'_'\r\n\t\t\t\t\t\t)[1]\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.openData = { ...row }\r\n\t\t\tthis.openVisible = true\r\n\t\t},\r\n\t\tloadCurrenyDate() {\r\n\t\t\tthis.$api\r\n\t\t\t\t.getCurrencyComboBoxList({\r\n\t\t\t\t\tpageIndex: 1,\r\n\t\t\t\t\tpageSize: 100\r\n\t\t\t\t})\r\n\t\t\t\t.then((_) => {\r\n\t\t\t\t\tconst data = _.data\r\n\t\t\t\t\tthis.currencyList = data.record\r\n\t\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n",null]}