{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\systemmanagement\\parameter\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\systemmanagement\\parameter\\index.vue","mtime":1617695097441},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport list from '@/mixins/list'\r\nimport { mapGetters } from 'vuex'\r\nimport { routerNames } from '@/utils/consts'\r\nimport { generateTitle } from '@/utils/i18n'\r\nimport { decimalValidateSix } from '@/utils/validate'\r\n\r\nexport default {\r\n\tname: routerNames.systemCurrency,\r\n\tmixins: [list],\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\thadSearch: false,\r\n\t\t\tloading: false,\r\n\t\t\treleaseTime: '',\r\n\t\t\tform: {\r\n\t\t\t\tid: -1\r\n\t\t\t},\r\n\t\t\turlDialogVisible: false,\r\n\t\t\turlDialogForm: {\r\n\t\t\t\tagentName: '',\r\n\t\t\t\ttype: '',\r\n\t\t\t\turl: '',\r\n\t\t\t\tdesc: ''\r\n\t\t\t},\r\n\t\t\tuserNames: [],\r\n\t\t\tcurrencyForm: {\r\n\t\t\t\tk: '',\r\n\t\t\t\tv: ''\r\n\t\t\t},\r\n\t\t\tipDialogVisible: false,\r\n\t\t\tisEdit: true,\r\n\t\t\tcurrentRow: {}\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapGetters(['globalDics']),\r\n\t\tipDialogRules() {\r\n\t\t\t/* eslint-disable */\r\n\t\t\tconst validateName = async (rule, value, callback) => {\r\n\t\t\t\tif (!/^[a-zA-Z0-9\\u4e00-\\u9fa5]+$/.test(value)) {\r\n\t\t\t\t\tcallback(new Error(this.$t('systemmanagement_currency_index_16')))\r\n\t\t\t\t} else if (value.length > 20) {\r\n\t\t\t\t\tcallback(new Error(this.$t('systemmanagement_parameter_index_25')))\r\n\t\t\t\t} else if (value.length < 2) {\r\n\t\t\t\t\tcallback(new Error(this.$t('systemmanagement_parameter_index_26')))\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t/* eslint-disable */\r\n\t\t\tconst validateCode = async (rule, value, callback) => {\r\n\t\t\t\tif (!/^[a-zA-Z]+$/.test(value)) {\r\n\t\t\t\t\tcallback(new Error(this.$t('systemmanagement_parameter_index_24')))\r\n\t\t\t\t} else if (value.length > 20) {\r\n\t\t\t\t\tcallback(new Error(this.$t('systemmanagement_parameter_index_25')))\r\n\t\t\t\t} else if (value.length < 2) {\r\n\t\t\t\t\tcallback(new Error(this.$t('systemmanagement_parameter_index_26')))\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst currencyRateValidate = (rule, value, callback) => {\r\n\t\t\t\tif (!decimalValidateSix(value)) {\r\n\t\t\t\t\tcallback(new Error(this.$t('systemmanagement_parameter_index_27')))\r\n\t\t\t\t} else if (value === 0 || value === '0') {\r\n\t\t\t\t\tcallback(new Error(this.$t('systemmanagement_parameter_index_28')))\r\n\t\t\t\t} else if (value < 0 || value > 10000) {\r\n\t\t\t\t\tcallback(new Error(this.$t('systemmanagement_parameter_index_29')))\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\tname: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\tmessage: this.$t('systemmanagement_parameter_index_30'),\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvalidator: validateName,\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\tcode: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\tmessage: this.$t('systemmanagement_parameter_index_31'),\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvalidator: validateCode,\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\tcurrencyRate: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\tvalidator: currencyRateValidate,\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcreated() {\r\n\t\t// 获取操作账号\r\n\t\tthis.$api.listUsername().then((res) => {\r\n\t\t\tif (res.code === 200) {\r\n\t\t\t\tthis.userNames = res.data\r\n\t\t\t}\r\n\t\t})\r\n\t},\r\n\tmounted() {\r\n\t\tthis.itemtimer = setInterval(() => {\r\n\t\t\tconst items = document.querySelectorAll('.el-form-item__error')\r\n\t\t\titems.forEach((i) => {\r\n\t\t\t\tif (i.innerHTML.includes(this.$t('systemmanagement_parameter_index_32'))) {\r\n\t\t\t\t\ti.innerHTML = this.$t('systemmanagement_parameter_index_32')\r\n\t\t\t\t}\r\n\t\t\t\tif (i.innerHTML.includes(this.$t('systemmanagement_parameter_index_24'))) {\r\n\t\t\t\t\ti.innerHTML = this.$t('systemmanagement_parameter_index_24')\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}, 1000)\r\n\t},\r\n\tdestroyed() {\r\n\t\tthis.itemtimer = null\r\n\t\twindow.clearInterval(this.itemtimer)\r\n\t},\r\n\tmethods: {\r\n\t\trenderInfo(modifys, item) {\r\n\t\t\tlet newValue\r\n\t\t\tif (item.includes(this.$t('systemmanagement_parameter_index_33'))) {\r\n\t\t\t\tnewValue = []\r\n\t\t\t\tmodifys && modifys.map((val) => newValue.push(generateTitle(val)))\r\n\t\t\t} else {\r\n\t\t\t\tnewValue = modifys\r\n\t\t\t}\r\n\t\t\treturn newValue\r\n\t\t},\r\n\t\thadChangeColor(pre, next) {\r\n\t\t\tif (JSON.stringify(pre) !== JSON.stringify(next)) {\r\n\t\t\t\treturn 'change-color'\r\n\t\t\t}\r\n\t\t},\r\n\t\tloadData() {\r\n\t\t\tthis.loading = true\r\n\t\t\tconst initData = {\r\n\t\t\t\tpageIndex: this.pageIndex,\r\n\t\t\t\tpageSize: this.pageSize\r\n\t\t\t}\r\n\t\t\tconst requestData = this.hadSearch\r\n\t\t\t\t? {\r\n\t\t\t\t\t\tid: this.form.id\r\n\t\t\t\t  }\r\n\t\t\t\t: {}\r\n\t\t\tconst form = {\r\n\t\t\t\t...initData,\r\n\t\t\t\t...requestData\r\n\t\t\t}\r\n\t\t\tthis.$api\r\n\t\t\t\t.getSystemParameterList(form)\r\n\t\t\t\t.then((_) => {\r\n\t\t\t\t\tthis.loading = false\r\n\t\t\t\t\tconst data = _.data\r\n\t\t\t\t\tthis.list = data.record\r\n\t\t\t\t\tthis.total = data.totalRecord\r\n\t\t\t\t})\r\n\t\t\t\t.catch(() => {\r\n\t\t\t\t\tthis.loading = false\r\n\t\t\t\t})\r\n\t\t},\r\n\t\thandleCurrentChange(val) {\r\n\t\t\tthis.loadData()\r\n\t\t},\r\n\t\thandleReset() {\r\n\t\t\tthis.form = {\r\n\t\t\t\tid: -1\r\n\t\t\t}\r\n\t\t\tthis.hadSearch = false\r\n\t\t\tthis.initList()\r\n\t\t},\r\n\t\thandleSearch() {\r\n\t\t\tthis.hadSearch = true\r\n\t\t\tthis.pageIndex = 1\r\n\t\t\tthis.loadData()\r\n\t\t},\r\n\t\teditRow(row) {\r\n\t\t\tthis.currentRow = row\r\n\t\t\tthis.isEdit = true\r\n\t\t\tthis.ipDialogVisible = true\r\n\t\t\tthis.currencyForm = {\r\n\t\t\t\tk: row.k,\r\n\t\t\t\tv: row.v,\r\n\t\t\t\tid: row.id\r\n\t\t\t}\r\n\t\t},\r\n\t\tstopRow(index, rows) {\r\n\t\t\trows.splice(index, 1)\r\n\t\t},\r\n\t\thandleCreateWhite() {\r\n\t\t\tthis.isEdit = false\r\n\t\t\tthis.ipDialogVisible = true\r\n\t\t\tthis.currencyForm = {\r\n\t\t\t\tk: '',\r\n\t\t\t\tv: '',\r\n\t\t\t\tid: ''\r\n\t\t\t}\r\n\t\t},\r\n\t\tonCancel() {\r\n\t\t\tthis.ipDialogVisible = false\r\n\t\t\tthis.$refs.currencyForm.clearValidate()\r\n\t\t},\r\n\t\tcommitIpDialog() {\r\n\t\t\tthis.$refs.currencyForm.validate((val) => {\r\n\t\t\t\tif (val) {\r\n\t\t\t\t\tconst form = {\r\n\t\t\t\t\t\tk: this.currencyForm.k,\r\n\t\t\t\t\t\tv: this.currencyForm.v,\r\n\t\t\t\t\t\tid: this.currencyForm.id\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst api = 'editSystemParameter'\r\n\t\t\t\t\tthis.$api[api](form).then(() => {\r\n\t\t\t\t\t\tthis.ipDialogVisible = false\r\n\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\tmessage: this.$t('systemmanagement_parameter_index_34')\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.loadData()\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n",null]}