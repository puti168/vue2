{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\authoritymanagement\\defaultrole\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\authoritymanagement\\defaultrole\\index.vue","mtime":1617695097405},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { mapGetters } from 'vuex'\r\nimport list from '@/mixins/list'\r\nimport EditRole from './components/EditRole'\r\nimport AuthoritySearch from './components/AuthoritySearch'\r\nimport { routerNames } from '@/utils/consts'\r\nimport SelectAgentTree from '@/components/SelectAgentTree'\r\nimport { i18nRoute } from '@/utils/i18n'\r\nimport Modal from '@/components/Modal'\r\nimport dayjs from 'dayjs'\r\nexport default {\r\n\tname: routerNames.systemRole,\r\n\tcomponents: { EditRole, SelectAgentTree, AuthoritySearch, Modal },\r\n\tmixins: [list],\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tcurOperation: '',\r\n\t\t\thadSearch: false,\r\n\t\t\tloading: false,\r\n\t\t\tlockVisible: false,\r\n\t\t\tdeleteDialog: false,\r\n\t\t\tdialogVisible2: false,\r\n\t\t\teditType: 0, // 0为线路商模板配置 1为普通商户模板配置 2为默认角色配置\r\n\t\t\tdrawer: false,\r\n\t\t\tcurrentPage: 1,\r\n\t\t\tform: {\r\n\t\t\t\ttime: '',\r\n\t\t\t\tsystemType: -1,\r\n\t\t\t\tagentId: '',\r\n\t\t\t\tuserName: '',\r\n\t\t\t\tquickSearch: 'team'\r\n\t\t\t},\r\n\t\t\troleData: {},\r\n\t\t\tpermissions: [],\r\n\t\t\tassignedPermissions: [],\r\n\t\t\tdialogVisible: false,\r\n\t\t\tcurrentData: {},\r\n\t\t\tcurrentIndex: -1,\r\n\t\t\tremark: '',\r\n\t\t\tlist: [],\r\n\t\t\tsearchDrawer: false\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapGetters(['name', 'userInfo']),\r\n\t\t...mapGetters(['buttonPermissions']),\r\n\t\tpickerOptions() {\r\n\t\t\tconst _this = this\r\n\t\t\treturn {\r\n\t\t\t\tdisabledDate(time) {\r\n\t\t\t\t\tconst now = dayjs()\r\n\t\t\t\t\t\t.endOf('day')\r\n\t\t\t\t\t\t.valueOf()\r\n\t\t\t\t\treturn time.getTime() > now\r\n\t\t\t\t},\r\n\t\t\t\tonPick({ maxDate, minDate }) {\r\n\t\t\t\t\tif (!maxDate) {\r\n\t\t\t\t\t\t_this.minDate = minDate\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tshortcuts: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttext: this.$t(`members_betrecord_index_584`),\r\n\t\t\t\t\t\tonClick(picker) {\r\n\t\t\t\t\t\t\tconst end = dayjs().endOf('day')\r\n\t\t\t\t\t\t\tconst start = dayjs().startOf('day')\r\n\t\t\t\t\t\t\tpicker.$emit('pick', [+start, +end])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttext: this.$t(`members_betrecord_index_585`),\r\n\t\t\t\t\t\tonClick(picker) {\r\n\t\t\t\t\t\t\tconst end = dayjs()\r\n\t\t\t\t\t\t\t\t.endOf('day')\r\n\t\t\t\t\t\t\t\t.subtract(1, 'd')\r\n\t\t\t\t\t\t\tconst start = dayjs()\r\n\t\t\t\t\t\t\t\t.startOf('day')\r\n\t\t\t\t\t\t\t\t.subtract(1, 'd')\r\n\t\t\t\t\t\t\tpicker.$emit('pick', [+start, +end])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttext: this.$t(`members_betrecord_index_586`),\r\n\t\t\t\t\t\tonClick(picker) {\r\n\t\t\t\t\t\t\tlet start, end\r\n\t\t\t\t\t\t\tconst weekNum = dayjs().day()\r\n\t\t\t\t\t\t\tif (weekNum === 0) {\r\n\t\t\t\t\t\t\t\tend = dayjs().endOf('day')\r\n\t\t\t\t\t\t\t\tstart = dayjs()\r\n\t\t\t\t\t\t\t\t\t.subtract(1, 'd')\r\n\t\t\t\t\t\t\t\t\t.startOf('week')\r\n\t\t\t\t\t\t\t\t\t.startOf('day')\r\n\t\t\t\t\t\t\t\t\t.add(1, 'd')\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tend = dayjs().endOf('day')\r\n\t\t\t\t\t\t\t\tstart = dayjs()\r\n\t\t\t\t\t\t\t\t\t.startOf('day')\r\n\t\t\t\t\t\t\t\t\t.startOf('week')\r\n\t\t\t\t\t\t\t\t\t.add(1, 'd')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tpicker.$emit('pick', [+start, +end])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttext: this.$t(`members_betrecord_index_587`),\r\n\t\t\t\t\t\tonClick(picker) {\r\n\t\t\t\t\t\t\tconst end = dayjs().endOf('day')\r\n\t\t\t\t\t\t\tconst start = dayjs().startOf('month')\r\n\t\t\t\t\t\t\tpicker.$emit('pick', [+start, +end])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttext: this.$t(`merchant_dailyrateaccount_index_799`),\r\n\t\t\t\t\t\tonClick(picker) {\r\n\t\t\t\t\t\t\tconst end = dayjs().endOf('day')\r\n\t\t\t\t\t\t\tconst start = dayjs()\r\n\t\t\t\t\t\t\t\t.startOf('day')\r\n\t\t\t\t\t\t\t\t.subtract(89, 'd')\r\n\t\t\t\t\t\t\tpicker.$emit('pick', [+start, +end])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t},\r\n\t\toptions() {\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\tvalue: 'self',\r\n\t\t\t\t\tlabel: this.$t('systemmanagement_ipwhite_index_1458')\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tvalue: 'under',\r\n\t\t\t\t\tlabel: this.$t('systemmanagement_ipwhite_index_1459')\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tvalue: 'team',\r\n\t\t\t\t\tlabel: this.$t('systemmanagement_ipwhite_index_1460')\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tloadData() {\r\n\t\t\tthis.loading = true\r\n\t\t\tconst initData = {\r\n\t\t\t\tpageSize: this.pageSize,\r\n\t\t\t\tpageIndex: this.pageIndex,\r\n\t\t\t\tstartDate: this.form.time ? this.form.time[0] : '',\r\n\t\t\t\tendDate: this.form.time ? this.form.time[1] : '',\r\n\t\t\t\tquickSearch: this.form.quickSearch,\r\n\t\t\t\tuserName: this.form.userName\r\n\t\t\t}\r\n\t\t\tconst requestData = this.hadSearch\r\n\t\t\t\t? {\r\n\t\t\t\t\t\tagentId: this.form.agentId,\r\n\t\t\t\t\t\tsystemType: this.form.systemType\r\n\t\t\t\t  }\r\n\t\t\t\t: {}\r\n\t\t\tconst form = {\r\n\t\t\t\t...initData,\r\n\t\t\t\t...requestData\r\n\t\t\t}\r\n\t\t\tthis.$api\r\n\t\t\t\t.adminUserManager(form)\r\n\t\t\t\t.then((_) => {\r\n\t\t\t\t\tthis.loading = false\r\n\t\t\t\t\tconst data = _.data\r\n\t\t\t\t\tthis.total = data.totalRecord\r\n\t\t\t\t\tthis.list = data.record\r\n\t\t\t\t})\r\n\t\t\t\t.catch(() => {\r\n\t\t\t\t\tthis.loading = false\r\n\t\t\t\t})\r\n\t\t},\r\n\t\thandleCurrentChange(val) {\r\n\t\t\tthis.loadData()\r\n\t\t},\r\n\t\thandleReset() {\r\n\t\t\tthis.hadSearch = false\r\n\t\t\tthis.form = {\r\n\t\t\t\ttime: '',\r\n\t\t\t\tsystemType: -1,\r\n\t\t\t\tagentId: '',\r\n\t\t\t\tuserName: '',\r\n\t\t\t\tquickSearch: 'team'\r\n\t\t\t}\r\n\t\t\tthis.initList()\r\n\t\t},\r\n\t\thandleCancle() {\r\n\t\t\tthis.dialogVisible = false\r\n\t\t\tthis.curOperation = 'cancle'\r\n\t\t},\r\n\t\thandleSearch() {\r\n\t\t\tthis.hadSearch = true\r\n\t\t\tthis.pageIndex = 1\r\n\t\t\tthis.loadData()\r\n\t\t},\r\n\t\t// 给菜单加入查看\r\n\t\tinsertCheck(permissions) {\r\n\t\t\tpermissions.forEach((element) => {\r\n\t\t\t\tif (element.children && element.children.length !== 0) {\r\n\t\t\t\t\telement.children.forEach((childElement) => {\r\n\t\t\t\t\t\tchildElement.children = childElement.children || []\r\n\t\t\t\t\t\tchildElement.children.unshift({\r\n\t\t\t\t\t\t\tchildren: null,\r\n\t\t\t\t\t\t\tid: 'list' + childElement.id,\r\n\t\t\t\t\t\t\tisExist: null,\r\n\t\t\t\t\t\t\tparentId: childElement.id,\r\n\t\t\t\t\t\t\tpath: childElement,\r\n\t\t\t\t\t\t\tpermissionName: this.$t('authoritymanagement_defaultrole_index_241'),\r\n\t\t\t\t\t\t\ttype: 1\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t// 获取已有权限 type为2的时候才有id\r\n\t\tgetRoleDetail(type, id, row) {\r\n\t\t\tconsole.log('222')\r\n\t\t\tconsole.log(id)\r\n\t\t\tif (type === 0) {\r\n\t\t\t\tconst api = 'getLineAgentTemplateConfig'\r\n\t\t\t\tthis.$api[api]({ id }).then((res) => {\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tif (!id) {\r\n\t\t\t\t\t\t\tthis.roleData = res.data\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst currentPermissions = []\r\n\t\t\t\t\t\tres.data.rolePermission &&\r\n\t\t\t\t\t\t\tres.data.rolePermission.forEach((element) => {\r\n\t\t\t\t\t\t\t\tif (element.isExist === '1' && element.type !== '0') {\r\n\t\t\t\t\t\t\t\t\tcurrentPermissions.push(element.id)\r\n\t\t\t\t\t\t\t\t} else if (element.isExist === '1' && element.type === '0') {\r\n\t\t\t\t\t\t\t\t\tcurrentPermissions.push(`list${element.id}`)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.assignedPermissions = currentPermissions\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tif (type === 1) {\r\n\t\t\t\tconst api = 'getAgentTemplateConfig'\r\n\t\t\t\tthis.$api[api]({ id }).then((res) => {\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tif (!id) {\r\n\t\t\t\t\t\t\tthis.roleData = res.data\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst currentPermissions = []\r\n\t\t\t\t\t\tres.data.rolePermission &&\r\n\t\t\t\t\t\t\tres.data.rolePermission.forEach((element) => {\r\n\t\t\t\t\t\t\t\tif (element.isExist === '1' && element.type !== '0') {\r\n\t\t\t\t\t\t\t\t\tcurrentPermissions.push(element.id)\r\n\t\t\t\t\t\t\t\t} else if (element.isExist === '1' && element.type === '0') {\r\n\t\t\t\t\t\t\t\t\tcurrentPermissions.push(`list${element.id}`)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.assignedPermissions = currentPermissions\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tif (type === 2) {\r\n\t\t\t\tconst api = 'userDetail'\r\n\t\t\t\tthis.$api[api]({ userId: row.userId }).then((res) => {\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tif (!id) {\r\n\t\t\t\t\t\t\tthis.roleData = res.data\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst currentPermissions = []\r\n\t\t\t\t\t\tres.data.assignedPermissions &&\r\n\t\t\t\t\t\t\tres.data.assignedPermissions.forEach((element) => {\r\n\t\t\t\t\t\t\t\tif (element.isExist === '1' && element.type !== '0') {\r\n\t\t\t\t\t\t\t\t\tcurrentPermissions.push(element.id)\r\n\t\t\t\t\t\t\t\t} else if (element.isExist === '1' && element.type === '0') {\r\n\t\t\t\t\t\t\t\t\tcurrentPermissions.push(`list${element.id}`)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.assignedPermissions = currentPermissions\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\tUnlock(index, row) {\r\n\t\t\tthis.currentData = { ...row }\r\n\t\t\tthis.currentIndex = index\r\n\t\t\tthis.lockVisible = true\r\n\t\t\tthis.modalType = row.status === 1 ? 2 : 1\r\n\t\t},\r\n\t\thandleSureLock() {\r\n\t\t\tconst params = {\r\n\t\t\t\tuserId: this.currentData.userId\r\n\t\t\t}\r\n\t\t\tthis.$api.unLockUser(params).then((res) => {\r\n\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\tthis.list[this.currentIndex].lockFlag = 0\r\n\t\t\t\t\tthis.lockVisible = false\r\n\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\tmessage: this.$t('merchant_merchantinfo_components_keysmanage_1004'),\r\n\t\t\t\t\t\ttype: 'success'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t// 找出父级\r\n\t\tfindRoots(data) {\r\n\t\t\tif (!data || data.length === 0) return\r\n\t\t\tconst roots = []\r\n\t\t\tconst childrens = []\r\n\t\t\tdata.forEach((element) => {\r\n\t\t\t\tif (element.parentId === 0) {\r\n\t\t\t\t\troots.push({\r\n\t\t\t\t\t\t...element,\r\n\t\t\t\t\t\tchildren: []\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tchildrens.push({\r\n\t\t\t\t\t\t...element,\r\n\t\t\t\t\t\tchildren: []\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.generateTree(roots, childrens)\r\n\t\t\treturn roots\r\n\t\t},\r\n\t\thandleSure() {\r\n\t\t\t// 重置管理员密码\r\n\t\t\tthis.$api\r\n\t\t\t\t.resetAdminPwd({\r\n\t\t\t\t\tagentId: this.currentData.id,\r\n\t\t\t\t\tagentName: this.currentData.agentName,\r\n\t\t\t\t\tagentCode: this.currentData.agentCode\r\n\t\t\t\t})\r\n\t\t\t\t.then((res) => {\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tthis.dialogVisible2 = false\r\n\t\t\t\t\t\treturn this.$message({\r\n\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\tmessage: this.$t('merchant_merchantinfo_index_1134')\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t},\r\n\t\t// 生成树形结构\r\n\t\tgenerateTree(parents, childrens) {\r\n\t\t\tif (!childrens || childrens.length === 0) return\r\n\t\t\tconst roots = []\r\n\t\t\tconst lefts = []\r\n\t\t\tchildrens.forEach((element) => {\r\n\t\t\t\tconst index = parents.findIndex((val) => val.id === element.parentId)\r\n\t\t\t\tif (index > -1) {\r\n\t\t\t\t\tparents[index].children.push(element)\r\n\t\t\t\t\troots.push(element)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlefts.push(element)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.generateTree(roots, lefts)\r\n\t\t},\r\n\t\tresetPassword(row) {\r\n\t\t\tthis.currentData = { ...row }\r\n\t\t\tthis.dialogVisible2 = true\r\n\t\t},\r\n\t\teditRow(index, row) {\r\n\t\t\tthis.loadPermissions(row)\r\n\t\t\tthis.drawer = true\r\n\t\t\tthis.editType = 2\r\n\t\t\tthis.roleData = { ...row }\r\n\t\t\tthis.getRoleDetail(this.editType, row.id, row)\r\n\t\t},\r\n\t\thandleNewRole(editType) {\r\n\t\t\tconsole.log('221122')\r\n\t\t\tthis.loadPermissions3()\r\n\t\t\tthis.drawer = true\r\n\t\t\tthis.editType = editType\r\n\t\t\tthis.getRoleDetail(editType)\r\n\t\t},\r\n\t\tshowAuthoritySearch() {\r\n\t\t\tthis.loadPermissions2()\r\n\t\t\tthis.searchDrawer = true\r\n\t\t},\r\n\t\tloadPermissions3() {\r\n\t\t\tthis.$api.merchantPermissions().then((_) => {\r\n\t\t\t\tif (_.code === 200) {\r\n\t\t\t\t\tthis.permissions = _.data || []\r\n\t\t\t\t\t// 增加查看权限，相当于菜单，这个是前端增加的，为了这个tree组件兼容，提交的时候需要过滤掉id为'list'的值\r\n\t\t\t\t\tthis.permissions.forEach((element) => {\r\n\t\t\t\t\t\tif (element.children && element.children.length !== 0) {\r\n\t\t\t\t\t\t\telement.children.forEach((childElement) => {\r\n\t\t\t\t\t\t\t\tchildElement.children = childElement.children || []\r\n\t\t\t\t\t\t\t\tchildElement.children.unshift({\r\n\t\t\t\t\t\t\t\t\tchildren: null,\r\n\t\t\t\t\t\t\t\t\tid: 'list' + childElement.id,\r\n\t\t\t\t\t\t\t\t\tisExist: null,\r\n\t\t\t\t\t\t\t\t\tparentId: childElement.id,\r\n\t\t\t\t\t\t\t\t\tpath: childElement,\r\n\t\t\t\t\t\t\t\t\tpermissionName: 'view',\r\n\t\t\t\t\t\t\t\t\ttype: 1\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.loopPermission(this.permissions)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\tmessage: this.$t('systemmanagement.systemmanagement_111')\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t// 获取角色的所有可操作权限\r\n\t\tloadPermissions(row) {\r\n\t\t\tthis.$api\r\n\t\t\t\t.userManagerPermission({\r\n\t\t\t\t\tsearchUserId: row.userId,\r\n\t\t\t\t\tagentCode: row.agentCode\r\n\t\t\t\t})\r\n\t\t\t\t.then((_) => {\r\n\t\t\t\t\tif (_.code === 200) {\r\n\t\t\t\t\t\tthis.permissions = _.data || []\r\n\t\t\t\t\t\t// 增加查看权限，相当于菜单，这个是前端增加的，为了这个tree组件兼容，提交的时候需要过滤掉id为'list'的值\r\n\t\t\t\t\t\tthis.permissions.forEach((element) => {\r\n\t\t\t\t\t\t\tif (element.children && element.children.length !== 0) {\r\n\t\t\t\t\t\t\t\telement.children.forEach((childElement) => {\r\n\t\t\t\t\t\t\t\t\tchildElement.children = childElement.children || []\r\n\t\t\t\t\t\t\t\t\tchildElement.children.unshift({\r\n\t\t\t\t\t\t\t\t\t\tchildren: null,\r\n\t\t\t\t\t\t\t\t\t\tid: 'list' + childElement.id,\r\n\t\t\t\t\t\t\t\t\t\tisExist: null,\r\n\t\t\t\t\t\t\t\t\t\tparentId: childElement.id,\r\n\t\t\t\t\t\t\t\t\t\tpath: childElement,\r\n\t\t\t\t\t\t\t\t\t\tpermissionName: 'view',\r\n\t\t\t\t\t\t\t\t\t\ttype: 1\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.loopPermission(this.permissions)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\tmessage: this.$t('systemmanagement.systemmanagement_111')\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t},\r\n\t\t// 获取权限项的筛选权限\r\n\t\tloadPermissions2() {\r\n\t\t\tthis.$api.merchantPermissions().then((_) => {\r\n\t\t\t\tif (_.code === 200) {\r\n\t\t\t\t\tthis.permissions = _.data || []\r\n\t\t\t\t\t// 增加查看权限，相当于菜单，这个是前端增加的，为了这个tree组件兼容，提交的时候需要过滤掉id为'list'的值\r\n\t\t\t\t\tthis.permissions.forEach((element) => {\r\n\t\t\t\t\t\tif (element.children && element.children.length !== 0) {\r\n\t\t\t\t\t\t\telement.children.forEach((childElement) => {\r\n\t\t\t\t\t\t\t\tchildElement.children = childElement.children || []\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\tmessage: this.$t('systemmanagement.systemmanagement_111')\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\tloopPermission(datas) {\r\n\t\t\tdatas.forEach((i) => {\r\n\t\t\t\ti.permissionName = i18nRoute(i.permissionName)\r\n\t\t\t\tif (i.children && i.children.length !== 0) {\r\n\t\t\t\t\tthis.loopPermission(i.children)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\tfilterRoleName() {\r\n\t\t\treturn this.$t('other_010')\r\n\t\t},\r\n\t\tfilterRemark() {\r\n\t\t\treturn this.$t('other_011')\r\n\t\t}\r\n\t}\r\n}\r\n",null]}