{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\gamemanagement\\tableconfig\\components\\EditTable.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\gamemanagement\\tableconfig\\components\\EditTable.vue","mtime":1615171048116},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { validPassword } from '@/utils/validate'\r\n\r\nexport default {\r\n\tname: 'Edituser',\r\n\tprops: {\r\n\t\ttype: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0\r\n\t\t},\r\n\t\tdrawer: Boolean,\r\n\t\tpermissions: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: () => []\r\n\t\t},\r\n\t\tassignedpermissions: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: () => []\r\n\t\t},\r\n\t\tuserdata: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: function() {\r\n\t\t\t\treturn {}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\ttransferKey: 0,\r\n\t\t\ttranferVal: [],\r\n\t\t\telDrawer: false,\r\n\t\t\tform: {\r\n\t\t\t\tnickName: '',\r\n\t\t\t\tuserName: '',\r\n\t\t\t\tpwd: '',\r\n\t\t\t\trePwd: ''\r\n\t\t\t},\r\n\t\t\tdirection: 'ttb',\r\n\t\t\tprefixAgentName: ''\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\trules() {\r\n\t\t\tconst validNumberEn12 = (rule, value, callback) => {\r\n\t\t\t\tif (/^([A-Za-z0-9_]{6,12})$/.test(value)) {\r\n\t\t\t\t\tcallback()\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback(new Error(this.$t('merchant.merchant_137')))\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst validNumberEnCn = (rule, value, callback) => {\r\n\t\t\t\tif (value && /^[\\u4e00-\\u9fa5a-zA-Z0-9_]{0,30}$/.test(value)) {\r\n\t\t\t\t\tcallback()\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback(new Error(this.$t('merchant.merchant_143')))\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst validatePwd = (rule, value, callback) => {\r\n\t\t\t\tif (value === '') {\r\n\t\t\t\t\tcallback(new Error(this.$t('systemmanagement.systemmanagement_126')))\r\n\t\t\t\t} else if (!validPassword(value)) {\r\n\t\t\t\t\tcallback(new Error(this.$t('merchant.merchant_137')))\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst validateRepwd = (rule, value, callback) => {\r\n\t\t\t\tif (value === '') {\r\n\t\t\t\t\tcallback(new Error(this.$t('systemmanagement.systemmanagement_128')))\r\n\t\t\t\t} else if (!validPassword(value)) {\r\n\t\t\t\t\tcallback(new Error(this.$t('merchant.merchant_137')))\r\n\t\t\t\t} else if (value !== this.form.pwd) {\r\n\t\t\t\t\tcallback(new Error(this.$t('systemmanagement.systemmanagement_129')))\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\tuserName: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\tmessage: this.$t('systemmanagement.systemmanagement_130'),\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvalidator: validNumberEn12,\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\tnickName: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\tmessage: this.$t('systemmanagement.systemmanagement_119'),\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{ validator: validNumberEnCn, trigger: 'blur' }\r\n\t\t\t\t],\r\n\t\t\t\tpwd: [{ required: true, validator: validatePwd, trigger: 'blur' }],\r\n\t\t\t\trePwd: [{ required: true, validator: validateRepwd, trigger: 'blur' }]\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\tdrawer(val) {\r\n\t\t\tthis.elDrawer = val\r\n\t\t\tif (val) {\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.$refs.form.clearValidate()\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\tuserdata: {\r\n\t\t\thandler(newVal) {\r\n\t\t\t\tif (!newVal.userName) {\r\n\t\t\t\t\t// this.$nextTick(() => {\r\n\t\t\t\t\t// \tthis.$refs.form.resetFields()\r\n\t\t\t\t\t// })\r\n\t\t\t\t}\r\n\t\t\t\tif (newVal) {\r\n\t\t\t\t\tthis.form = { ...newVal }\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdeep: true\r\n\t\t},\r\n\t\t'userdata.agentType': {\r\n\t\t\thandler(val) {\r\n\t\t\t\tif (val) {\r\n\t\t\t\t\tthis.prefixAgentName = this.prefixByAgentType(val)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdeep: true\r\n\t\t},\r\n\t\tassignedpermissions: {\r\n\t\t\thandler(newVal, oldVal) {\r\n\t\t\t\tthis.tranferVal = this.filterAssignedKeys(newVal)\r\n\t\t\t},\r\n\t\t\tdeep: true\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t// 根据当前登录者的信息显示新建用户前缀\r\n\t\tprefixByAgentType(agentType) {\r\n\t\t\tif (agentType === 3) {\r\n\t\t\t\treturn 'PTZ'\r\n\t\t\t} else if (agentType === 1) {\r\n\t\t\t\treturn 'XLZ'\r\n\t\t\t} else {\r\n\t\t\t\treturn 'SHZ'\r\n\t\t\t}\r\n\t\t},\r\n\t\tfilterAssignedKeys(arr) {\r\n\t\t\tconst list = []\r\n\t\t\tarr.forEach((item) => {\r\n\t\t\t\tif (item.isExist === '1') {\r\n\t\t\t\t\tlist.push(item.id)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\treturn list\r\n\t\t},\r\n\t\thandleSure() {\r\n\t\t\tthis.$refs.form.validate((valid) => {\r\n\t\t\t\tif (valid) {\r\n\t\t\t\t\t// 获取参数\r\n\t\t\t\t\tconst form = {\r\n\t\t\t\t\t\tnickName: this.form.nickName,\r\n\t\t\t\t\t\tpwd: this.form.pwd,\r\n\t\t\t\t\t\trePwd: this.form.rePwd,\r\n\t\t\t\t\t\troleIds: this.tranferVal,\r\n\t\t\t\t\t\tuserName:\r\n\t\t\t\t\t\t\t(this.type !== 1\r\n\t\t\t\t\t\t\t\t? this.prefixByAgentType(this.userdata.agentType)\r\n\t\t\t\t\t\t\t\t: '') + this.form.userName,\r\n\t\t\t\t\t\tuserId: this.form.id\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.type === 0) {\r\n\t\t\t\t\t\tthis.$api.merchantAddUser(form).then((_) => {\r\n\t\t\t\t\t\t\tif (_.code === 200) {\r\n\t\t\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\t\t\tmessage: this.$t('systemmanagement.systemmanagement_103')\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tthis.$emit('update:drawer', false)\r\n\t\t\t\t\t\t\t\tthis.$emit('handleCallBack')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$api.merchantEditUser(form).then((_) => {\r\n\t\t\t\t\t\t\tif (_.code === 200) {\r\n\t\t\t\t\t\t\t\tthis.resetForm()\r\n\t\t\t\t\t\t\t\tthis.$emit('update:drawer', false)\r\n\t\t\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\t\t\tmessage: this.$t('systemmanagement.systemmanagement_39')\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tthis.$emit('handleCallBack')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\thandleClose() {\r\n\t\t\tthis.resetForm()\r\n\t\t\tthis.$emit('update:drawer', false)\r\n\t\t},\r\n\t\tresetForm() {\r\n\t\t\tthis.$refs.form.resetFields()\r\n\t\t\tthis.transferKey = +new Date()\r\n\t\t\tthis.tranferVal = []\r\n\t\t}\r\n\t}\r\n}\r\n",null]}