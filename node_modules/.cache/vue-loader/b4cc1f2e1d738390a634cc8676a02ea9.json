{"remainingRequest":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\abnormalRound\\players\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\src\\views\\abnormalRound\\players\\index.vue","mtime":1617695097403},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\merchant-manager-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { mapGetters } from 'vuex'\r\nimport list from '@/mixins/list'\r\nimport SelectAgentTree from '@/components/SelectAgentTree'\r\nimport ResultShow from '@/components/ResultShow'\r\nimport dayjs from 'dayjs'\r\nimport { routerNames } from '@/utils/consts'\r\nimport router from '@/router'\r\nimport IPLogin from '@/views/abnormalRound/players/components/IPLogin'\r\n\r\nexport default {\r\n\tname: routerNames.abnormalplayers,\r\n\tcomponents: { SelectAgentTree, ResultShow, IPLogin },\r\n\tmixins: [list],\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tdrawer: false,\r\n\t\t\thadSearch: false,\r\n\t\t\tloading: false,\r\n\t\t\treleaseTime: '',\r\n\t\t\tbetDialogVisible: false,\r\n\t\t\tdialogShow: false,\r\n\t\t\tbetStatusList: [\r\n\t\t\t\tthis.$t('members.members_16'),\r\n\t\t\t\tthis.$t('members.members_17'),\r\n\t\t\t\tthis.$t('members.members_18'),\r\n\t\t\t\tthis.$t('members.members_19'),\r\n\t\t\t\tthis.$t('members.members_20'),\r\n\t\t\t\tthis.$t('members.members_21')\r\n\t\t\t],\r\n\t\t\tform: {\r\n\t\t\t\ttime: '',\r\n\t\t\t\tplayerName: '',\r\n\t\t\t\tid: '',\r\n\t\t\t\troundNo: '',\r\n\t\t\t\tabnormalType: -1,\r\n\t\t\t\tsearchAgentId: ''\r\n\t\t\t},\r\n\t\t\tamountData: {},\r\n\t\t\tcurrentData: {},\r\n\t\t\tuserAgentType: '',\r\n\t\t\t// 是否展示列表选择\r\n\t\t\tisShowChoiceColumn: false,\r\n\t\t\tprevIndex: 1,\r\n\t\t\tipData: null,\r\n\t\t\tsummary: {},\r\n\t\t\tkey: Date.now()\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapGetters(['userInfo']),\r\n\t\t...mapGetters(['globalDics']),\r\n\t\tpickerOptions() {\r\n\t\t\tconst _this = this\r\n\t\t\treturn {\r\n\t\t\t\tdisabledDate(time) {\r\n\t\t\t\t\tconst now = dayjs()\r\n\t\t\t\t\t\t.endOf('day')\r\n\t\t\t\t\t\t.valueOf()\r\n\t\t\t\t\treturn time.getTime() > now\r\n\t\t\t\t},\r\n\t\t\t\tonPick({ maxDate, minDate }) {\r\n\t\t\t\t\tif (!maxDate) {\r\n\t\t\t\t\t\t_this.minDate = minDate\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tshortcuts: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttext: this.$t('abnormalround_players_index_158'),\r\n\t\t\t\t\t\tonClick(picker) {\r\n\t\t\t\t\t\t\tconst end = dayjs().endOf('day')\r\n\t\t\t\t\t\t\tconst start = dayjs().startOf('day')\r\n\t\t\t\t\t\t\tpicker.$emit('pick', [+start, +end])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttext: this.$t('abnormalround_players_index_159'),\r\n\t\t\t\t\t\tonClick(picker) {\r\n\t\t\t\t\t\t\tconst end = dayjs()\r\n\t\t\t\t\t\t\t\t.endOf('day')\r\n\t\t\t\t\t\t\t\t.subtract(1, 'd')\r\n\t\t\t\t\t\t\tconst start = dayjs()\r\n\t\t\t\t\t\t\t\t.startOf('day')\r\n\t\t\t\t\t\t\t\t.subtract(1, 'd')\r\n\t\t\t\t\t\t\tpicker.$emit('pick', [+start, +end])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttext: this.$t('abnormalround_players_index_160'),\r\n\t\t\t\t\t\tonClick(picker) {\r\n\t\t\t\t\t\t\tlet start, end\r\n\t\t\t\t\t\t\tconst weekNum = dayjs().day()\r\n\t\t\t\t\t\t\tif (weekNum === 0) {\r\n\t\t\t\t\t\t\t\tend = dayjs().endOf('day')\r\n\t\t\t\t\t\t\t\tstart = dayjs()\r\n\t\t\t\t\t\t\t\t\t.subtract(1, 'd')\r\n\t\t\t\t\t\t\t\t\t.startOf('week')\r\n\t\t\t\t\t\t\t\t\t.startOf('day')\r\n\t\t\t\t\t\t\t\t\t.add(1, 'd')\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tend = dayjs().endOf('day')\r\n\t\t\t\t\t\t\t\tstart = dayjs()\r\n\t\t\t\t\t\t\t\t\t.startOf('day')\r\n\t\t\t\t\t\t\t\t\t.startOf('week')\r\n\t\t\t\t\t\t\t\t\t.add(1, 'd')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tpicker.$emit('pick', [+start, +end])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttext: this.$t('abnormalround_players_index_161'),\r\n\t\t\t\t\t\tonClick(picker) {\r\n\t\t\t\t\t\t\tconst end = dayjs().endOf('day')\r\n\t\t\t\t\t\t\tconst start = dayjs().startOf('month')\r\n\t\t\t\t\t\t\tpicker.$emit('pick', [+start, +end])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmounted() {\r\n\t\tdocument.addEventListener('click', this.showColumn)\r\n\t},\r\n\tdestroyed() {\r\n\t\tdocument.removeEventListener('click', this.showColumn)\r\n\t},\r\n\tmethods: {\r\n\t\tclassFilter(item) {\r\n\t\t\tswitch (item) {\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\treturn 'dangerState'\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\treturn 'warningState'\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\treturn 'disableState'\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 失去焦点的时候重置\r\n\t\tonTimeBlur() {\r\n\t\t\tthis.minDate = null\r\n\t\t},\r\n\t\tgetAmoutColor(value) {\r\n\t\t\tif (value > 0) {\r\n\t\t\t\treturn 'green'\r\n\t\t\t} else if (value < 0) {\r\n\t\t\t\treturn 'red'\r\n\t\t\t}\r\n\t\t\treturn ''\r\n\t\t},\r\n\t\tshowColumn(e) {\r\n\t\t\tconst icon = document.getElementById('icon')\r\n\t\t\tconst list = document.getElementById('list')\r\n\t\t\tif (icon && !icon.contains(e.target) && list && !list.contains(e.target)) {\r\n\t\t\t\tthis.isShowChoiceColumn = false\r\n\t\t\t}\r\n\t\t},\r\n\t\tloadData() {\r\n\t\t\t// 2020-4-28修改为开始和结束时间不能跨月\r\n\t\t\tif (this.form.time) {\r\n\t\t\t\tconst month0 = dayjs(this.form.time[0]).month()\r\n\t\t\t\tconst month1 = dayjs(this.form.time[1]).month()\r\n\t\t\t\tif (month0 !== month1) {\r\n\t\t\t\t\treturn this.$message({\r\n\t\t\t\t\t\tmessage: this.$t('abnormalround_players_index_162'),\r\n\t\t\t\t\t\ttype: 'warning'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.loading = true\r\n\r\n\t\t\tif (this.$route.query && JSON.stringify(this.$route.query) !== '{}') {\r\n\t\t\t\tconst query = this.$route.query || {}\r\n\t\t\t\tthis.form.roundNo = query.roundNo\r\n\t\t\t\tthis.form.agentId = query.agentId\r\n\t\t\t\tthis.key = Date.now()\r\n\t\t\t\trouter.push(this.$route.path)\r\n\t\t\t}\r\n\r\n\t\t\tconst initData = {\r\n\t\t\t\tpageSize: this.pageSize,\r\n\t\t\t\tpageIndex: this.pageIndex,\r\n\t\t\t\tstartTime: this.form.time[0],\r\n\t\t\t\tendTime: this.form.time[1],\r\n\t\t\t\tplayerName: this.form.playerName,\r\n\t\t\t\tsearchAgentId: this.form.agentId,\r\n\t\t\t\troundNo: this.form.roundNo,\r\n\t\t\t\tid: this.form.id,\r\n\t\t\t\tabnormalType: this.form.abnormalType\r\n\t\t\t}\r\n\r\n\t\t\tconst form = {\r\n\t\t\t\t...initData\r\n\t\t\t}\r\n\r\n\t\t\tthis.$api\r\n\t\t\t\t.pageAbnormalRoundAccountBad(form)\r\n\t\t\t\t.then((_) => {\r\n\t\t\t\t\tthis.loading = false\r\n\t\t\t\t\tif (_.code === 200) {\r\n\t\t\t\t\t\tconst data = _.data\r\n\t\t\t\t\t\tthis.list = data.record\r\n\t\t\t\t\t\tthis.summary = data.summary || {}\r\n\t\t\t\t\t\tthis.total = data.totalRecord\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.catch(() => {\r\n\t\t\t\t\tthis.pageIndex = this.prevIndex\r\n\t\t\t\t\tthis.list = []\r\n\t\t\t\t\tthis.amountData = {}\r\n\t\t\t\t\tthis.total = 0\r\n\t\t\t\t\tthis.loading = false\r\n\t\t\t\t})\r\n\t\t},\r\n\t\tfilterAbnormalType(value) {\r\n\t\t\treturn value === 1\r\n\t\t\t\t? this.$t('abnormalround_players_index_132')\r\n\t\t\t\t: value === 2\r\n\t\t\t\t? this.$t('abnormalround_players_index_133')\r\n\t\t\t\t: value === 3\r\n\t\t\t\t? this.$t('abnormalround_players_index_2')\r\n\t\t\t\t: '-'\r\n\t\t},\r\n\t\thandleCurrentChange(val) {\r\n\t\t\tthis.prevIndex = this.pageIndex\r\n\t\t\tthis.pageIndex = val\r\n\t\t\tthis.loadData()\r\n\t\t},\r\n\t\thandleReset() {\r\n\t\t\tif (this.$route.query && JSON.stringify(this.$route.query) !== '{}') {\r\n\t\t\t\trouter.push(this.$route.path, () => {\r\n\t\t\t\t\tthis.resetCommon()\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tthis.resetCommon()\r\n\t\t\t}\r\n\t\t},\r\n\t\tresetCommon() {\r\n\t\t\tthis.hadSearch = false\r\n\t\t\tthis.form = {\r\n\t\t\t\ttime: '',\r\n\t\t\t\tplayerName: '',\r\n\t\t\t\tid: '',\r\n\t\t\t\troundNo: '',\r\n\t\t\t\tbetStatus: -1,\r\n\t\t\t\tsearchAgentId: ''\r\n\t\t\t}\r\n\t\t\tthis.initList()\r\n\t\t},\r\n\t\thandleSearch() {\r\n\t\t\tthis.pageIndex = 1\r\n\t\t\tthis.hadSearch = true\r\n\t\t\tthis.loadData()\r\n\t\t},\r\n\t\tgetSummaries(param) {\r\n\t\t\tconst { columns } = param\r\n\t\t\tconst sums = []\r\n\t\t\tcolumns.forEach((column, index) => {\r\n\t\t\t\tif (index === 0) {\r\n\t\t\t\t\tsums[index] = this.$t('abnormalround_players_index_155')\r\n\t\t\t\t}\r\n\t\t\t\tif (column.property === 'badAmount') {\r\n\t\t\t\t\tsums[index] = this.formatCurrency(this.summary[`totalBadAmount`])\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\treturn sums\r\n\t\t},\r\n\t\tshowChoiceColumn() {\r\n\t\t\tthis.isShowChoiceColumn = !this.isShowChoiceColumn\r\n\t\t},\r\n\t\tshowResult(row) {\r\n\t\t\tthis.dialogShow = true\r\n\t\t\tthis.currentData = { ...row }\r\n\t\t},\r\n\t\t// ip登录轨迹\r\n\t\tcheckLoginIp(row) {\r\n\t\t\tthis.drawer = true\r\n\t\t\tthis.ipData = { ...row }\r\n\t\t}\r\n\t}\r\n}\r\n",null]}